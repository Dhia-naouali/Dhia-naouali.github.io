<html class="notion-html" data-notion-html="web" data-notion-version="23.13.20251231.1212" lang="en" style="--full-viewport-height: 19861px; --direction: 1;"><head lang="en"><meta charset="utf-8"/><meta content="width=device-width,height=device-height,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" name="viewport"/><title>A Gentle Introduction to Distributed Training</title><meta content="en_US" property="og:locale"/><meta content="yes" name="mobile-web-app-capable"/><meta content="app-id=1232780281" property="apple-itunes-app"/><link href="https://decisive-stomach-548.notion.site/images/favicon.ico" rel="shortcut icon" type="image/x-icon"/><link href="/images/logo-ios.png" rel="apple-touch-icon"/><meta content="telephone=no" name="format-detection"/><meta content="no" name="msapplication-tap-highlight"/><link href="4e8dd02ae0f74049b708c079bcd1feb979cff37d.css" media="print" rel="stylesheet"/><style>body{background:#fff}body.dark{background:#191919}@keyframes startup-shimmer-animation{0%{transform:translateX(-100%) translateZ(0)}100%{transform:translateX(100%) translateZ(0)}}@keyframes startup-shimmer-fade-in{0%{opacity:0}100%{opacity:1}}@keyframes startup-spinner-rotate{0%{transform:rotate(0) translateZ(0)}100%{transform:rotate(360deg) translateZ(0)}}#initial-loading-spinner{position:fixed;height:100vh;width:100vw;z-index:-1;display:none;align-items:center;justify-content:center}#initial-loading-spinner .spinner{position:relative;display:inline-block;height:22px;width:22px;pointer-events:none}#initial-loading-spinner .spinner__circle{position:absolute;top:0;left:0;width:22px;height:22px;border-radius:50%;border:2px solid rgba(28,19,1,.11)}.dark #initial-loading-spinner .spinner__circle{border-color:rgba(255,255,235,.1)}#initial-loading-spinner .spinner__arc{position:absolute;top:0;left:0;width:22px;height:22px;border-radius:50%;border-top:2px solid #383836;border-right:2px solid #383836;border-bottom:2px solid transparent;border-left:2px solid transparent;mask:linear-gradient(90deg,transparent 66.66%,#000 66.66%);animation:startup-spinner-rotate 1.2s linear infinite}.dark #initial-loading-spinner .spinner__arc{border-color:#f0efed}#skeleton{background:#fff;position:fixed;height:100vh;width:100vw;z-index:-1;display:none;overflow:hidden}#initial-loading-spinner.show,#skeleton.show{display:flex}body.dark #skeleton{background:#191919}.notion-front-page #skeleton,.notion-mobile #skeleton{display:none}#skeleton-sidebar{background-color:#f9f8f7;box-shadow:inset calc(var(--direction,1) * -1px) 0 0 0 #eeeeec;display:flex;width:240px;flex-direction:column;padding:12px 14px;overflow:hidden}body.dark #skeleton-sidebar{background-color:#202020;box-shadow:inset calc(var(--direction,1) * -1px) 0 0 0 #2a2a2a}#skeleton.isElectron #skeleton-sidebar{padding-top:46px}#skeleton .row{display:flex;margin-bottom:11px;align-items:center}#skeleton .row.fadein{animation:1s ease-in 0s 1 normal both running startup-shimmer-fade-in}#skeleton .chevron{width:12px;height:12px;display:block;margin-right:4px;fill:rgba(227,226,224,.5)}body.dark #skeleton .chevron{fill:#2f2f2f}.startup-shimmer{background:rgba(227,226,224,.5);overflow:hidden;position:relative}body.dark .startup-shimmer{background:#2f2f2f}.startup-shimmer::before{content:"";position:absolute;height:100%;width:100%;z-index:1;animation:1s linear infinite startup-shimmer-animation;background:linear-gradient(90deg,rgba(0,0,0,0) 0,rgba(0,0,0,.03) 50%,rgba(0,0,0,0) 100%)}body.dark .startup-shimmer::before{background:linear-gradient(90deg,transparent 0,rgba(86,86,86,.1) 50%,transparent 100%)}#skeleton .icon{width:20px;height:20px;border-radius:4px}#skeleton .text{height:10px;border-radius:10px}#skeleton .draggable{-webkit-app-region:drag;position:absolute;top:0;left:0;width:100%;height:36px;display:none}#skeleton.isElectron .draggable{display:block}</style><link href="38b0ff1846a3d5be29b008e3b9af769b7303e6ae.css" rel="stylesheet"/><link href="4e546d47f94b085ffaaf1260a576311dfb4fe0ad.css" rel="stylesheet" type="text/css"/><link href="628c8fc7905073af3408adab70c480c0b601ee8e.css" rel="stylesheet" type="text/css"/><link href="8fd257a4c299589199d1d7d5b3ffeb6e208f075a.css" rel="stylesheet" type="text/css"/><style>


		
		
		.assistant-grouped-edit-chat-container .assistant-grouped-edit-insert {
			background: initial !important;
			border-bottom: initial !important;
			color: var(--c-texPri) !important;
		}

		.assistant-grouped-edit-chat-container .assistant-grouped-edit-remove {
			background: initial !important;
			border-bottom: initial !important;
			color: var(--c-texDis) !important;
		}
	
	</style>
	
	<style>
.notion-topbar { display: none !important; }

.notion-page-content, 
.notion-scroller > div:not(.notion-page-content) {
  max-width: 900px !important;
  margin-left: auto !important;
  margin-right: auto !important;
  padding-left: 40px !important;
  padding-right: 40px !important;
  box-sizing: border-box !important;
}

.notion-page-cover, .notion-scroller > div:first-child {
  max-width: 100% !important;
  margin-left: 0 !important;
  margin-right: 0 !important;
  padding-left: 0 !important;
  padding-right: 0 !important;
  width: 100% !important;
}

.notion-page-content {
  font-size: 1.15em !important;
}

.notion-page-content h1,
.notion-title {
  font-size: 2.5em !important;
}
</style>
	
	
	
	
	
	<link href="aa4af630f8206694204f498d9b3ba4cc2b517f5c.css" rel="stylesheet" type="text/css"/><link href="58deccad03ab320749215a65df251e0d3ba21702.css" rel="stylesheet" type="text/css"/><link href="e1d809d762eeca23edf0cb31bb17bf3c703085f5.css" rel="stylesheet"/><link href="/A-Gentle-Introduction-to-Distributed-Training-2cc425ccedaa801d89c7c8f4aff62473" rel="canonical"/></head><body class="notion-body"><noscript><style>.main{display:flex;justify-content:center;align-items:center;height:100vh;background:#fffefc;color:#37352f;line-height:1.5;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,"Apple Color Emoji",Arial,sans-serif,"Segoe UI Emoji","Segoe UI Symbol";-webkit-font-smoothing:auto;text-align:center;flex-direction:column;margin:0;padding:40px 20px 60px 20px}</style><div class="main"><img alt="Notion" src="84f0a28204788accc66d47bc0a4bdb4ebc96c62e.svg" style="width:40px;margin:0 auto;display:block"/><p>JavaScript must be enabled in order to use Notion.<br/>Please enable JavaScript to continue.</p></div></noscript><style id="scroll-properties">
		* {
			scrollbar-width: 15px;
			scrollbar-color: rgba(255, 255, 255, 0.2)  rgba(0, 0, 0, 0);
		}
	</style><script src="1172e9111a5fb396bcb8a05870b5eabf8abf221c.js" type="text/javascript"></script><div id="notion-app"><div class="notion-dark-theme" style="display: contents;"><div class="notion-app-inner notion-dark-theme" style='color: var(--c-texPri); fill: currentcolor; line-height: 1.5; font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; -webkit-font-smoothing: auto; background-color: var(--c-bacPri); transition: height 0.1s;'><div style="height: 100%;"><div class="notion-cursor-listener" style="width: 100vw; height: 100%; position: relative; display: flex; flex: 1 1 0%; background: var(--c-bacPri); cursor: text;"><div class="notion-print-ignore" style="height: 68px; position: fixed; top: 0px; inset-inline: 0px; bottom: 0px; z-index: 1000; width: 240px; transform: translateY(-100px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width, transform;"><a href="#main" id="skip-to-content" rel="noopener noreferrer" role="link" style="display: block; color: white; text-decoration: none; user-select: none; transition: background 20ms ease-in; cursor: pointer; position: absolute; inset-inline-start: 12px; top: 12px; width: 200px; height: 48px; overflow: hidden; z-index: 9999; padding: 12px; background: var(--c-bluBacAccPri); text-align: center; border-radius: 16px;"><div style="display: flex; align-items: center; justify-content: center; gap: 8px;">Skip to content<svg aria-hidden="true" class="arrowUTurnUpRightFill directional-icon" role="graphics-symbol" style="width: 20px; height: 20px; display: block; fill: inherit; flex-shrink: 0; color: inherit;" viewBox="0 0 20 20"><path d="M12.231 4.969A.875.875 0 1 1 13.47 3.73l4.4 4.4a.875.875 0 0 1 0 1.238l-4.4 4.4a.875.875 0 1 1-1.238-1.238l2.906-2.906H6a2.375 2.375 0 1 0 0 4.75h1.42a.875.875 0 0 1 0 1.75H6a4.125 4.125 0 1 1 0-8.25h9.138z"></path></svg></div></a></div><div class="" style="order: 3; display: flex; flex-direction: column; width: 100%; overflow: hidden; isolation: auto; background: transparent; position: relative;"><header style="background: var(--c-bacPri); max-width: 100vw; z-index: 100; user-select: none; position: relative;"><div class="notion-topbar" style="width: calc(100% + 0px); max-width: 100vw; height: 44px; opacity: 1; transition: opacity 700ms, color 700ms; position: relative; inset-inline-start: 0px;"><div style="display: flex; justify-content: space-between; align-items: center; overflow: hidden; height: 44px; padding-inline: 12px 10px;"><div class="notranslate shadow-cursor-breadcrumb" style="display: flex; align-items: center; line-height: 1.2; font-size: 14px; height: 100%; flex-grow: 0; margin-inline-end: 8px; min-width: 0px;"><div aria-disabled="true" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: default; display: inline-flex; align-items: center; justify-content: unset; height: 24px; padding-inline: 6px; border-radius: 6px; white-space: nowrap; font-size: 14px; font-weight: 400; line-height: 1.2; color: var(--c-texPri); flex-shrink: 1; min-width: 0px;" tabindex="-1"><div data-popup-origin="true" style="display: contents;"><span class="notranslate" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 240px;">A Gentle Introduction to Distributed Training</span></div></div></div><div style="flex-grow: 1; flex-shrink: 1;"></div><div style="display: flex; justify-content: space-between; padding-inline-start: 10px;"><div style="display: flex; align-items: center;"><div role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; display: inline-flex; align-items: center; justify-content: unset; height: 28px; padding-inline: 8px; border-radius: 6px; white-space: nowrap; font-size: 14px; font-weight: 400; line-height: 1.2; color: var(--c-texPri); flex-shrink: 0; min-width: 0px;" tabindex="0"><svg aria-hidden="true" class="magnifyingGlass" role="graphics-symbol" style="width: 22px; height: 22px; display: block; fill: inherit; flex-shrink: 0; color: inherit;" viewBox="0 0 20 20"><path d="M8.875 2.625a6.25 6.25 0 1 0 3.955 11.09l3.983 3.982a.625.625 0 1 0 .884-.884l-3.983-3.982a6.25 6.25 0 0 0-4.84-10.205m-5 6.25a5 5 0 1 1 10 0 5 5 0 0 1-10 0"></path></svg></div><div data-popup-origin="true" style="display: contents;"><div data-popup-origin="true" style="display: contents;"><div aria-expanded="false" aria-haspopup="dialog" aria-label="Share site to socials" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; display: inline-flex; align-items: center; justify-content: unset; height: 28px; padding-inline: 8px; border-radius: 6px; white-space: nowrap; font-size: 14px; font-weight: 400; line-height: 1.2; color: var(--c-texPri); flex-shrink: 0; min-width: 0px;" tabindex="0"><svg aria-hidden="true" class="squareAndArrowUp" role="graphics-symbol" style="width: 22px; height: 22px; display: block; fill: inherit; flex-shrink: 0; color: inherit;" viewBox="0 0 20 20"><path d="M9.533.62a.625.625 0 0 1 .884 0l2.5 2.5a.625.625 0 1 1-.884.884l-1.408-1.408V11a.625.625 0 1 1-1.25 0V2.546L7.917 4.004a.625.625 0 1 1-.884-.883z"></path><path d="M8.125 5.125H5.5A2.125 2.125 0 0 0 3.375 7.25v7.5c0 1.174.951 2.125 2.125 2.125h9a2.125 2.125 0 0 0 2.125-2.125v-7.5A2.125 2.125 0 0 0 14.5 5.125h-2.625v1.25H14.5c.483 0 .875.392.875.875v7.5a.875.875 0 0 1-.875.875h-9a.875.875 0 0 1-.875-.875v-7.5c0-.483.392-.875.875-.875h2.625z"></path></svg></div></div></div><div data-popup-origin="true" style="display: contents;"><div role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; display: inline-flex; align-items: center; justify-content: unset; height: 28px; padding-inline: 8px; border-radius: 6px; white-space: nowrap; font-size: 14px; font-weight: 400; line-height: 1.2; color: var(--c-texPri); flex-shrink: 0; min-width: 0px;" tabindex="0"><svg aria-hidden="true" class="duplicate" role="graphics-symbol" style="width: 22px; height: 22px; display: block; fill: inherit; flex-shrink: 0; color: inherit;" viewBox="0 0 20 20"><path d="M4.5 2.375A2.125 2.125 0 0 0 2.375 4.5V12c0 1.174.951 2.125 2.125 2.125h1.625v1.625c0 1.174.951 2.125 2.125 2.125h7.5a2.125 2.125 0 0 0 2.125-2.125v-7.5a2.125 2.125 0 0 0-2.125-2.125h-1.625V4.5A2.125 2.125 0 0 0 12 2.375zm8.375 3.75H8.25A2.125 2.125 0 0 0 6.125 8.25v4.625H4.5A.875.875 0 0 1 3.625 12V4.5c0-.483.392-.875.875-.875H12c.483 0 .875.392.875.875zm-5.5 2.125c0-.483.392-.875.875-.875h7.5c.483 0 .875.392.875.875v7.5a.875.875 0 0 1-.875.875h-7.5a.875.875 0 0 1-.875-.875z"></path></svg></div></div><div data-popup-origin="true" style="display: contents;"><div aria-expanded="false" aria-haspopup="dialog" aria-label="More actions" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; display: flex; align-items: center; justify-content: center; width: 32px; height: 28px; border-radius: 4px;" tabindex="0"><svg aria-hidden="true" class="ellipsis" role="graphics-symbol" style="width: 22px; height: 22px; display: block; fill: inherit; flex-shrink: 0; color: inherit;" viewBox="0 0 20 20"><path d="M4 11.375a1.375 1.375 0 1 0 0-2.75 1.375 1.375 0 0 0 0 2.75m6 0a1.375 1.375 0 1 0 0-2.75 1.375 1.375 0 0 0 0 2.75m6 0a1.375 1.375 0 1 0 0-2.75 1.375 1.375 0 0 0 0 2.75"></path></svg></div></div><div role="button" style="user-select: none; transition: background 0.1s ease-in-out; cursor: pointer; display: inline-flex; align-items: center; justify-content: center; height: 32px; padding-inline: 12px; border-radius: 6px; white-space: nowrap; font-size: 14px; font-weight: 500; line-height: 1.2; flex-shrink: 0; background: var(--c-bacAccPri); color: var(--c-texInvPri); fill: var(--c-texInvPri); padding: 0px 10px; margin-inline-start: 8px;" tabindex="0">Get Notion free</div></div></div></div></div></header><main class="notion-frame" id="main" style="flex-grow: 0; flex-shrink: 1; display: flex; flex-direction: column; background: var(--c-bacPri); z-index: 1; height: calc(-44px + 100vh); max-height: 100%; position: relative; padding-bottom: 0px; width: 1920px; transform: translateX(calc(var(--direction, 1) * 0px)); transition-duration: 200ms; transition-timing-function: ease; transition-property: width, transform;"><div class="notion-selectable-container" style="display: contents;"><div class="notion-scroller vertical" style="z-index: 1; display: flex; flex-direction: column; flex-grow: 1; position: relative; align-items: center; overflow: hidden auto;"><div class="sticky-portal-target" data-sticky-stack-name="default" style="position: sticky; z-index: 85; width: 100%; top: 0px; inset-inline-start: 0px; height: 0px; flex: 0 1 0%;"></div><div style="position: absolute; top: 0px; inset-inline-start: 0px; z-index: 99;"><div class="notion-selectable-hover-menu-item"></div></div><div aria-disabled="true" aria-label="Start typing to edit text" aria-multiline="true" class="whenContentEditable" data-content-editable-root="true" role="textbox" style="caret-color: var(--c-texPri); width: 100%; display: flex; flex-direction: column; position: relative; align-items: center; flex-grow: 1; --whenContentEditable--WebkitUserModify: read-write-plaintext-only;"><span data-content-editable-root-tiny-selection-trap="true" style="height: 1px; width: 1px; caret-color: transparent; margin-top: -1px;"></span><div class="layout" style="padding-bottom: 30vh; transform: translateX(calc(var(--direction, 1) * 0px)); transition-duration: 200ms; transition-timing-function: ease; transition-property: transform;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" style="user-select: none; --pseudoSelection--background: transparent; display: contents;"><div class="layout-margin-right" style="width: 100%; grid-row: 1 / -1; padding-inline-start: 0px; position: sticky; top: 0px; inset-inline-end: 0px; z-index: 80; transition: opacity 0.2s; opacity: 1; visibility: visible; pointer-events: none;"><div style="width: 100%; height: 0px;"></div><div class="hide-scrollbar ignore-scrolling-container notion-floating-table-of-contents" style="position: absolute; top: 0px; width: 100%; height: calc(-44px + 100vh); display: flex; flex-direction: column; pointer-events: none;"><div style="display: flex;"><div contenteditable="false" data-content-editable-void="true" style="width: 100%;"><div style="max-height: 19607px; margin-bottom: 60px; pointer-events: auto;"><div style="max-height: 400px; display: flex; flex-direction: row; position: absolute; top: 130px; inset-inline-end: 0px; overflow-y: hidden; opacity: 1; transition-duration: 200ms; transition-timing-function: ease; transition-property: opacity;"><div style="width: 56px; display: flex; flex-direction: column; justify-content: center; padding-bottom: 12px; padding-inline-end: 8px;"><div style="display: flex; flex-direction: column; gap: 12px; padding-inline-start: 20px; padding-bottom: 12px; height: 100%;"><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--c-palGra800); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: 0px 0px 3px var(--c-palGra800); border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div></div></div></div></div></div></div></div></div></div><div class="layout-full" style="isolation: isolate;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" style="user-select: none; --pseudoSelection--background: transparent; width: 100%; display: flex; flex-direction: column; align-items: center; flex-shrink: 0; flex-grow: 0; z-index: 2; transform: translateX(calc(var(--direction, 1) * 0px)); transition-duration: 200ms; transition-timing-function: ease; transition-property: transform;"></div></div><div class="layout-content" style="margin-inline-start: -4px;"><div style="width: 100%; display: flex; flex-direction: column; align-items: center; flex-shrink: 0; flex-grow: 0;"><div style="max-width: 100%; padding-inline-start: calc(0px + env(safe-area-inset-left)); width: 100%;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" style="user-select: none; --pseudoSelection--background: transparent; pointer-events: none;"><div style="display: flow-root; pointer-events: auto;"></div><div><div class="notion-page-controls" style='display: flex; padding-top: 80px; padding-bottom: 4px; justify-content: flex-start; flex-wrap: wrap; margin-inline-start: -1px; color: var(--c-texTer); font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; pointer-events: auto;'></div></div></div><div style="padding-inline-end: calc(0px + env(safe-area-inset-right));"><div><div class="notion-selectable notion-page-block" data-block-id="2cc425cc-edaa-801d-89c7-c8f4aff62473" dir="ltr" style="color: var(--c-texPri); font-weight: 700; line-height: 1.2; font-size: 40px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; cursor: default; display: flex; align-items: center;"><h1 class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder="New page" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 0px; padding-inline: 2px; font-size: 1em; font-weight: inherit; margin: 0px; cursor: default;">A Gentle Introduction to Distributed Training</h1><div contenteditable="false" data-content-editable-void="true"></div></div><div contenteditable="false" data-content-editable-void="true" style="margin-inline-start: 4px;"></div></div></div></div></div></div><div class="layout-content" style="margin-inline-start: -2px; margin-top: 8px;"><div class="notion-page-content" style="flex-shrink: 0; flex-grow: 1; max-width: 100%; display: flex; align-items: flex-start; flex-direction: column; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-size: 15px; letter-spacing: 0.055em; line-height: 1.6; width: 100%; z-index: 4; padding-top: 8px; padding-bottom: 0px; padding-inline: 0px;"><div class="notion-selectable notion-divider-block" data-block-id="2cc425cc-edaa-80e6-9ac8-e02e727a3ef9" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 2px; margin-bottom: 1px;"><div class="notion-cursor-default" style="display: flex; align-items: center; justify-content: center; pointer-events: auto; width: 100%; height: 13px; flex: 0 0 auto;"><div role="separator" style="width: 100%; height: 1px; visibility: visible; border-bottom: 1px solid var(--ca-borPriTra);"></div></div></div><div class="notion-selectable notion-header-block" data-block-id="2cc425cc-edaa-80f7-ae4f-e7a53514229c" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;">Introduction: the memory bottleneck</h2><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-809e-9ef6-db9cc500544c" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">as models get larger and larger a single device won’t get us through training although the largest portion of memory is often not occupied by the model parameters themselves but by stored intermediate values required for training</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-807b-81b4-d1f1d78882e2" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">to better understand the problem, let’s consider a simple <span class="notion-text-equation-token" contenteditable="false" data-token-index="1" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">L</mi></mrow><annotation encoding="application/x-tex">\mathrm{L}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathrm">L</span></span></span></span></span><span>﻿</span></span> layers MLP each with 128 perceptrons and 128 as the input dimension, assuming all used values in f<span class="notion-enable-hover" data-token-index="3" style="font-weight:600">loat32 </span>and ignoring biases for simplicity</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2d9425cc-edaa-80ca-a8a1-cf715543fa07" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">(we’ll also ignore the optimizer state for simplicity)</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2d9425cc-edaa-8056-b62a-f2b55409e85b" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">the model parameters occupy:</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-equation-block" data-block-id="2cc425cc-edaa-80a1-b677-d024aa5114a1" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 4px; margin-bottom: 4px;"><div contenteditable="false" data-content-editable-void="true" style="display: flex; position: relative;"><div data-popup-origin="true" style="display: contents;"><div aria-expanded="false" aria-haspopup="dialog" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; position: relative; width: 100%; border-radius: 10px;" tabindex="0"><div style="display: flex; padding: 4px 8px; width: 100%; flex-direction: column; overflow: auto; color: inherit; fill: inherit;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">_</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi></mrow><mo>=</mo><msup><mn>128</mn><mn>2</mn></msup><mo>∗</mo><mi mathvariant="normal">L</mi><mo>∗</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">\mathrm{params\_mem} = 128² * \mathrm{L} * 4</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.7406em;vertical-align:-0.31em;"></span><span class="mord"><span class="mord mathrm">params_mem</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord">12</span><span class="mord"><span class="mord">8</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathrm">L</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span></span></div></div></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-80bd-a896-ca259cd77d6e" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">on the other hand the intermediate activation values to store during training needed to compute the gradients during backpropagation for each sample in the batch occupy:</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-equation-block" data-block-id="2cc425cc-edaa-8017-b450-f82915a6606f" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 4px; margin-bottom: 4px;"><div contenteditable="false" data-content-editable-void="true" style="display: flex; position: relative;"><div data-popup-origin="true" style="display: contents;"><div aria-expanded="false" aria-haspopup="dialog" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; position: relative; width: 100%; border-radius: 10px;" tabindex="0"><div style="display: flex; padding: 4px 8px; width: 100%; flex-direction: column; overflow: auto; color: inherit; fill: inherit;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">_</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi></mrow><mo>=</mo><mi mathvariant="normal">B</mi><mo>∗</mo><mn>128</mn><mo>∗</mo><mi mathvariant="normal">L</mi><mo>∗</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">\mathrm{activations\_mem} = \mathrm{B} * 128 * \mathrm{L} * 4</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.9779em;vertical-align:-0.31em;"></span><span class="mord"><span class="mord mathrm">activations_mem</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathrm">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">128</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathrm">L</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span></span></div></div></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-80a1-9d59-ff4700baf426" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">in this case whether the memory space occupied by activations (saved intermediate values) will over-weight the model’s params or not depends on whether the batch size exceeds the model width 128</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-equation-block" data-block-id="2d9425cc-edaa-80f3-ac86-ca7f4681ca81" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 4px; margin-bottom: 4px;"><div contenteditable="false" data-content-editable-void="true" style="display: flex; position: relative;"><div data-popup-origin="true" style="display: contents;"><div aria-expanded="false" aria-haspopup="dialog" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; position: relative; width: 100%; border-radius: 10px;" tabindex="0"><div style="display: flex; padding: 4px 8px; width: 100%; flex-direction: column; overflow: auto; color: inherit; fill: inherit;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">p</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">_</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi></mrow><mo>&lt;</mo><mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">_</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">m</mi></mrow><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext><mn>128</mn><mo>&lt;</mo><mi mathvariant="normal">B</mi></mrow><annotation encoding="application/x-tex">\mathrm{params\_mem} \lt \mathrm{activations\_mem} \iff  128 \lt \mathrm{B}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8491em;vertical-align:-0.31em;"></span><span class="mord"><span class="mord mathrm">params_mem</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9779em;vertical-align:-0.31em;"></span><span class="mord"><span class="mord mathrm">activations_mem</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⟺</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord">128</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathrm">B</span></span></span></span></span></div></div></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-8061-966d-d14a61bbe9c3" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">in models where the same params / tensors are used for multiple operations (e.g residual connections, per token operations) the parameters themselves won’t grow in size with the sequence length (:number of tokens) but the activations will sure do, as a result the activations memory space will easily over weight the parameters memory space (by orders of magnitude in some applications)</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="2da425cc-edaa-8074-810c-db9f691b2a2f" dir="ltr" style="width: 100%; max-width: 1905px; align-self: center; margin-top: 4px; margin-bottom: 4px; transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div><div contenteditable="false" data-content-editable-void="true"><div aria-labelledby=":r2:" role="figure"><div style="display: flex; width: fit-content;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative; border-radius: 10px;"><div><div class="" style="width: 100%; height: 100%;"><img alt="" referrerpolicy="same-origin" src="d0502e47696ecf8f191d1ece110f138891a6af3e.png" style="display: block; object-fit: cover; border-radius: 2px; height: 100.912px; pointer-events: auto; width: 100%; max-height: 100.912px;"/></div></div></div><div style="left: 0px; top: 0px; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); pointer-events: none; opacity: 0; position: absolute; transition: opacity 100ms ease-in-out;"></div></div></div></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="2cc425cc-edaa-80ed-9ff2-dfbe983a44fa" dir="ltr" style="width: 100%; max-width: 1905px; align-self: center; margin-top: 4px; margin-bottom: 4px; transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div><div contenteditable="false" data-content-editable-void="true"><div aria-labelledby=":r3:" role="figure"><div style="display: flex; width: fit-content;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative; border-radius: 10px;"><div><div class="" style="width: 100%; height: 100%;"><img alt="" referrerpolicy="same-origin" src="aba06ae4d14cc8b9abf74ef94cb971a2125c9d18.png" style="display: block; object-fit: cover; border-radius: 2px; height: 461.724px; pointer-events: auto; width: 100%; max-height: 461.724px;"/></div></div></div><div style="left: 0px; top: 0px; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); pointer-events: none; opacity: 0; position: absolute; transition: opacity 100ms ease-in-out;"></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-800f-94df-cc5477abde1f" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="2cc425cc-edaa-800a-b6a0-d8818452bf49" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;">Data Parallel</h2><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-805f-83a7-c33dc2db8048" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">one of the simplest solutions for such encounter, on a single device, would be gradient accumulation which is computing the gradient of the entire batch on multiple steps (splitting the batch over <span class="notion-enable-hover" data-token-index="1" style="font-weight:600">n</span> micro-batches and accumulating the gradients on each backward pass) which will require <span class="notion-enable-hover" data-token-index="3" style="font-weight:600">n </span>times less memory space for activations by transforming the computing the gradients of the entire batch into a sequential process (computing the gradients for the first [batch / n] samples, the second [batch / n] samples, …)</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-8089-a8c7-efa41c2e376c" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">Using multiple devices we can simply optimize that through parallelization, still computing the gradient of a single micro-batch (:[batch / n] samples) per run but instead of computing them in a sequence on the same device we would clone the entire model on <span class="notion-enable-hover" data-token-index="1" style="font-weight:600">n </span>different devices and run a micro-batch on each, as a result, after a single time step we have the gradients for all samples, computed independently and sharded across devices. These gradients are then synchronized via a collective <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="3" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>All-Reduce</span></div> operation, which reduces (sums) the per-device gradients and distributes the averaged result back to every model replica, after which each device applies the optimizer update using this shared gradient.</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2d9425cc-edaa-80a3-994b-e67e2dba96b9" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="2cc425cc-edaa-8038-9e79-e7bbee262e9b" dir="ltr" style="width: 100%; max-width: 1905px; align-self: center; margin-top: 4px; margin-bottom: 4px; transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div><div contenteditable="false" data-content-editable-void="true"><div aria-labelledby=":r4:" role="figure"><div style="display: flex; width: fit-content;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative; border-radius: 10px;"><div><div class="" style="width: 100%; height: 100%;"><img alt="" referrerpolicy="same-origin" src="5f98f45d00e0bde47702169c2b297b5f86503311.png" style="display: block; object-fit: cover; border-radius: 2px; height: 638.867px; pointer-events: auto; width: 100%; max-height: 638.867px;"/></div></div></div><div style="left: 0px; top: 0px; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); pointer-events: none; opacity: 0; position: absolute; transition: opacity 100ms ease-in-out;"></div></div></div></div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="2cc425cc-edaa-8077-8f1a-d96c1d4e2e57" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;">Fully Sharded Data Parallel</h2><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-8085-ae03-f05c2d4a34c6" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">the main gain from the Data Parallel approach is that we’re processing a “larger” batch at the same time utilizing multiple devices, the main drawbacks are devices communications which is quite negligeable at this stage since it’s used ~once per batch</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-8055-a0c5-eb14829c2cb1" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">the “we can do better” here is avoiding storage redundancy, more specidifcally, we’re currently storing the same model weights replicated on all devices. as discussed earlier we’ve already mitigated the largest memory space (: activations) but we did nothing about the model params memory space, which is still quite significant (varies case by case)</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-80e6-8e41-fd4ec732c5cd" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-column_list-block" data-block-id="2d9425cc-edaa-80c3-bff0-ce7a42d4adc7" dir="auto" style="width: 100%; max-width: 1713px; align-self: center; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex;"><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(43.75% - 20.125px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="2d9425cc-edaa-80c7-9e2a-fd28a51a6990" dir="auto" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-image-block" data-block-id="2cc425cc-edaa-8006-840f-d4310707cdd4" dir="ltr" style="width: 100%; max-width: 100%; align-self: flex-start; margin-top: 4px; margin-bottom: 0px; transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div><div contenteditable="false" data-content-editable-void="true"><div aria-labelledby=":r5:" role="figure"><div style="display: flex; width: fit-content;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative; border-radius: 10px;"><div><div class="" style="width: 100%; height: 100%;"><img alt="" referrerpolicy="same-origin" src="3d7b2d65a83357c2d26e382331de2480b881dda1.png" style="display: block; object-fit: cover; border-radius: 2px; height: 281.471px; pointer-events: auto; width: 100%; max-height: 281.471px;"/></div></div></div><div style="left: 0px; top: 0px; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); pointer-events: none; opacity: 0; position: absolute; transition: opacity 100ms ease-in-out;"></div></div></div><div style="position: relative;"><div aria-label="Start typing to edit text" class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" id=":r5:" placeholder="Write a caption…" role="textbox" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); font-size: 14px; line-height: 1.4; color: var(--c-texSec); padding-top: 6px; padding-bottom: 6px; padding-inline-start: 2px;" tabindex="0">a single device view: a single micro-batch, a chunk of params</div><div style="position: absolute; top: 3.5px; inset-inline-end: 0px; background: var(--ca-bacTerTra); color: var(--c-texSec); border-radius: 6px; opacity: 0; transition: opacity 300ms ease-in; overflow: hidden;"><div aria-disabled="true" aria-label="Add alt text" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: default; padding: 4px 6px; font-size: 12px; font-weight: 500; letter-spacing: 0.2px;" tabindex="-1">ALT</div></div></div></div></div></div></div></div></div><div style="position: relative; width: 46px; flex-grow: 0; flex-shrink: 0; transition: opacity 200ms ease-out; opacity: 0;"></div><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(56.25% - 25.875px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="2d9425cc-edaa-80f0-be53-d7abd4f6d9b4" dir="auto" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-80e3-8c64-ce7681273d8e" dir="auto" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">the high level idea behind FSDP (fully sharded data parallel) is to not replicate the model parameters across all devices but rather store (mostly) a single copy sharded across them, in other words each device will only store a chunk of model parameters, furthermore sharding won’t be depth wise but rather width wise</div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-8027-9e3c-c94512d8d94e" dir="auto" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">:for each block in our model we’ll shard its parameters across all devices instead of replicating’em</div><div></div></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-80eb-8afb-ff8c4549df35" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">initially each device will have as input a single micro-batch, exactly as in Data Parallel, model parameters too will be sharded across devices and not entirely present on each</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-800a-bf18-e9a30220521c" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">during the forward pass, for each model layer / block each device will collect the rest of the params tensor in order to compute and store activations of its micro-batch, and then only keep its original chunk of the params tesnor.</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="2d9425cc-edaa-809a-8789-df23c0717326" dir="ltr" style="width: 100%; max-width: 1905px; align-self: center; margin-top: 4px; margin-bottom: 4px; transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div><div contenteditable="false" data-content-editable-void="true"><div aria-labelledby=":r6:" role="figure"><div style="display: flex; width: fit-content;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative; border-radius: 10px;"><div><div class="" style="width: 100%; height: 100%;"><img alt="" referrerpolicy="same-origin" src="889039455703c55e73f774e76fa6aef7a52486ae.png" style="display: block; object-fit: cover; border-radius: 2px; height: 1046.7px; pointer-events: auto; width: 100%; max-height: 1046.7px;"/></div></div></div><div style="left: 0px; top: 0px; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); pointer-events: none; opacity: 0; position: absolute; transition: opacity 100ms ease-in-out;"></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2d9425cc-edaa-80f8-80a7-f78041d90037" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2d9425cc-edaa-8004-8846-e7bbce79a47b" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">During the backpropagation pass, computation <span class="notion-enable-hover" data-token-index="1" style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:inherit;text-underline-offset:10%;color:inherit;word-wrap:break-word">proceeds block by block</span>. for each block, its params are <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="3" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>all-gather</span></div>ed in order to apply the global upstream gradient propagated from downstream layers. using that global (all micro-batches) gradient, we compute gradients of the loss w.r.t the block’s activations (for downstream gradient propagation) and with respect to its parameters (for updates / optimization).</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2d9425cc-edaa-80df-8d55-cce0bc6e85a0" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">Once the param gradients for the block are produced, they are <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>reduce-scatter</span></div>ed so that each device retains only the shard of the globally averaged gradient corresponding to its params shard</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="2d9425cc-edaa-80f3-bd06-f79037761553" dir="ltr" style="width: 100%; max-width: 1905px; align-self: center; margin-top: 4px; margin-bottom: 4px; transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div><div contenteditable="false" data-content-editable-void="true"><div aria-labelledby=":r7:" role="figure"><div style="display: flex; width: fit-content;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative; border-radius: 10px;"><div><div class="" style="width: 100%; height: 100%;"><img alt="" referrerpolicy="same-origin" src="5ab525205bf2b7927ebfde729e6fb10ca830b9e1.png" style="display: block; object-fit: cover; border-radius: 2px; height: 1534.85px; pointer-events: auto; width: 100%; max-height: 1534.85px;"/></div></div></div><div style="left: 0px; top: 0px; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); pointer-events: none; opacity: 0; position: absolute; transition: opacity 100ms ease-in-out;"></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2d9425cc-edaa-8080-8128-d02fbe093439" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-8079-80f8-c5009fa3781a" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">Focusing on evolving from Data Parallel to FSDP, we’re exchanging memory space for communication overhead, to have a better gain-to-loss ratio few tweaks are used in practice.</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-8003-b8b8-fa23ae020598" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">The main free lunch here is selecting which parameter tensors to shards and which not, for example bias vectors aren’t usually a burden memory-space wise, in contrast to larger tensors. Leading most engineers to only shard tensors larger than a certain threshold to avoid the communication overhead on those relatively small tensors.</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2d9425cc-edaa-80a1-9809-c804571e6d94" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">Another optimization exploits GPU stream parallelism by asynchronously prefetching the next block’s parameters while computing the current block’s activations, overlapping communication with computation to reduce idle time.</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2d9425cc-edaa-80c1-ae67-c811305b9d41" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="2d9425cc-edaa-80ca-9084-fe4a9cf63f00" dir="ltr" style="width: 100%; max-width: 1905px; align-self: center; margin-top: 4px; margin-bottom: 4px; transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div><div contenteditable="false" data-content-editable-void="true"><div aria-labelledby=":r8:" role="figure"><div style="display: flex; width: fit-content;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative; border-radius: 10px;"><div><div class="" style="width: 100%; height: 100%;"><img alt="" referrerpolicy="same-origin" src="2420f1cfc3454b7ba7b449eab28c47ed538959a2.png" style="display: block; object-fit: cover; border-radius: 2px; height: 478.478px; pointer-events: auto; width: 100%; max-height: 478.478px;"/></div></div></div><div style="left: 0px; top: 0px; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); pointer-events: none; opacity: 0; position: absolute; transition: opacity 100ms ease-in-out;"></div></div></div><div style="position: relative;"><div aria-label="Start typing to edit text" class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" id=":r8:" placeholder="Write a caption…" role="textbox" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); font-size: 14px; line-height: 1.4; color: var(--c-texSec); padding-top: 6px; padding-bottom: 6px; padding-inline-start: 2px;" tabindex="0">                    overlapping compute &amp; communication</div><div style="position: absolute; top: 3.5px; inset-inline-end: 0px; background: var(--ca-bacTerTra); color: var(--c-texSec); border-radius: 6px; opacity: 0; transition: opacity 300ms ease-in; overflow: hidden;"><div aria-disabled="true" aria-label="Add alt text" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: default; padding: 4px 6px; font-size: 12px; font-weight: 500; letter-spacing: 0.2px;" tabindex="-1">ALT</div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2d9425cc-edaa-80af-9145-e7261e71ba82" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">While FSDP reduces memory pressure by sharding parameters, it still assumes data-parallel execution. A different axis of parallelism is to shard the model itself along its depth.</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-sub_header-block" data-block-id="2cc425cc-edaa-80a8-97b7-d1e313586f6c" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1.4em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h3 class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 2" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.5em; line-height: 1.3; margin: 0px;">Pipeline Parallel</h3><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-808c-9a89-d5304115914d" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">Another direction to utilize multiple devices for training is spreading them along the direction of data flow, by sharding the model depth-wise on multiple devices. In this setup the model is split into consecutive groups of blocks, where each group lives on a single device. each device, given an input (the previous device’s output), performs its computation and produces an output to be fed into the next device (containing the next group of layers) until the last layer of the model.</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2d9425cc-edaa-80e3-b674-c7b41db65a98" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">Although simple in principle, the sequential nature is the main bottleneck to overcome.</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="2d9425cc-edaa-80c9-80ba-c92db97d5c8a" dir="ltr" style="width: 100%; max-width: 1905px; align-self: center; margin-top: 4px; margin-bottom: 4px; transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div><div contenteditable="false" data-content-editable-void="true"><div aria-labelledby=":r9:" role="figure"><div style="display: flex; width: fit-content;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative; border-radius: 10px;"><div><div class="" style="width: 100%; height: 100%;"><img alt="" referrerpolicy="same-origin" src="66986613dd9d875a9ddb80730591ef2d24824835.png" style="display: block; object-fit: cover; border-radius: 2px; height: 503.051px; pointer-events: auto; width: 100%; max-height: 503.051px;"/></div></div></div><div style="left: 0px; top: 0px; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); pointer-events: none; opacity: 0; position: absolute; transition: opacity 100ms ease-in-out;"></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-8048-bacf-dfc8659dfc4d" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">when working with multiple micro-batches the main hold-off of this strategy become clear. In a naive pipline execution fashion where <span class="notion-enable-hover" data-token-index="1" style="font-weight:600">all forward</span> passes are executed first followed by <span class="notion-enable-hover" data-token-index="3" style="font-weight:600">all backward</span> passes, each device will store the activations from each batch until its backward pass is executed which won’t happen until all batches pass the entire model / sequence of devices</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2d9425cc-edaa-809f-b5f7-fb4fa9f56e92" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="2d9425cc-edaa-80b2-90e3-cb0137760545" dir="ltr" style="width: 100%; max-width: 1905px; align-self: center; margin-top: 4px; margin-bottom: 4px; transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div><div contenteditable="false" data-content-editable-void="true"><div aria-labelledby=":ra:" role="figure"><div style="display: flex; width: fit-content;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative; border-radius: 10px;"><div><div class="" style="width: 100%; height: 100%;"><img alt="" referrerpolicy="same-origin" src="156c64a52e4af07f4aa7e8b7a38e05e5bb3bf2f7.png" style="display: block; object-fit: cover; border-radius: 2px; height: 1364.85px; pointer-events: auto; width: 100%; max-height: 1364.85px;"/></div></div></div><div style="left: 0px; top: 0px; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); pointer-events: none; opacity: 0; position: absolute; transition: opacity 100ms ease-in-out;"></div></div></div><div style="position: relative;"><div aria-label="Start typing to edit text" class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" id=":ra:" placeholder="Write a caption…" role="textbox" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); font-size: 14px; line-height: 1.4; color: var(--c-texSec); padding-top: 6px; padding-bottom: 6px; padding-inline-start: 2px;" tabindex="0">mb: micro-batch*</div><div style="position: absolute; top: 3.5px; inset-inline-end: 0px; background: var(--ca-bacTerTra); color: var(--c-texSec); border-radius: 6px; opacity: 0; transition: opacity 300ms ease-in; overflow: hidden;"><div aria-disabled="true" aria-label="Add alt text" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: default; padding: 4px 6px; font-size: 12px; font-weight: 500; letter-spacing: 0.2px;" tabindex="-1">ALT</div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-80b4-94be-cfb0a1fb3006" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">Along with the memory issue, storing all micro-batche activations until their corresponding backward pass occur, it’s easy to see that depending on the pipeline depth and number of micro-batches, devices become <span class="notion-enable-hover" data-token-index="1" style="font-weight:600">idle</span> during the fill phase of the forward pass, during the transition to the backward pass and during the drain phase. These idle regions are referred to as “pipeline bubble”.</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2da425cc-edaa-8073-afbe-c640369abf8d" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2da425cc-edaa-8093-bafa-db461658f0e9" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">Few variations of the plain vanilla pipeline parallel try to address these issues, we discuss few of them next.</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-sub_header-block" data-block-id="2cc425cc-edaa-8065-b747-c5ac5fb7ac2d" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1.4em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h3 class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 2" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.5em; line-height: 1.3; margin: 0px;">1F1B: one forward one backward</h3><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-80ff-a5ca-ea11028f9ea5" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">The one forward one backward scheduling strategy aim to reduce activations storage on devices by interleaving forward and backward passes instead of a completely seperating them.</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-8085-b277-e4dbf90ddee5" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">Once the first micro-batch reaches the last device in the pipeline (the filling phase) we enter the new 1F1B phase which simply atlernate between computing a forward pass on all pipeline stages / devices in a timeslote and computing a backward pass on all devices the next one untill the drain phase (when all forward passes are done).</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="2cc425cc-edaa-8088-baa8-d98bd5692bb2" dir="ltr" style="width: 100%; max-width: 1905px; align-self: center; margin-top: 4px; margin-bottom: 4px; transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div><div contenteditable="false" data-content-editable-void="true"><div aria-labelledby=":rb:" role="figure"><div style="display: flex; width: fit-content;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative; border-radius: 10px;"><div><div class="" style="width: 100%; height: 100%;"><img alt="" referrerpolicy="same-origin" src="bea3eae6528980b5b2a96e82498b5cabe7fe1fe4.png" style="display: block; object-fit: cover; border-radius: 2px; height: 983.339px; pointer-events: auto; width: 100%; max-height: 983.339px;"/></div></div></div><div style="left: 0px; top: 0px; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); pointer-events: none; opacity: 0; position: absolute; transition: opacity 100ms ease-in-out;"></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-807a-88c7-d090e47c93ea" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">Following that logic each a micro-batches activations won’t be stored for as long as when using the vanilla strategy.</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-sub_header-block" data-block-id="2cc425cc-edaa-8047-a8ea-dba0afe44391" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1.4em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h3 class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 2" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.5em; line-height: 1.3; margin: 0px;">DualPipe</h3><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-802f-b36e-dbf81ac95f87" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">Another interesting approach utilize the device’s streams parallelism to achieve an even better forward-backward overlap. Instead of alternating both passes it assiges separate streams for forward pass computations, and others for backward pass computations and executes them simulatenously.</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="2d9425cc-edaa-8016-b85f-fe32dcfae940" dir="ltr" style="width: 100%; max-width: 1905px; align-self: center; margin-top: 4px; margin-bottom: 4px; transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div><div contenteditable="false" data-content-editable-void="true"><div aria-labelledby=":rc:" role="figure"><div style="display: flex; width: fit-content;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative; border-radius: 10px;"><div><div class="" style="width: 100%; height: 100%;"><img alt="" referrerpolicy="same-origin" src="4cca220028e72d9ce020add84b0d300af576f44d.png" style="display: block; object-fit: cover; border-radius: 2px; height: 735.357px; pointer-events: auto; width: 100%; max-height: 735.357px;"/></div></div></div><div style="left: 0px; top: 0px; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); pointer-events: none; opacity: 0; position: absolute; transition: opacity 100ms ease-in-out;"></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-8059-842f-db29423411b7" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2cc425cc-edaa-80b8-bdaf-d6226fcd7c9e" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">On each device during the forward propagation a micro-batche’s activations will be computed in forward streams and stored in VRAM and at the same time some other micro-batche’s gradients are being computed on the backward stream by the already stored activations achieving a much better computation overlap and an even smaller pipeline bubble.</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="2cc425cc-edaa-8067-bbe0-d8fb1189adda" dir="ltr" style="width: 100%; max-width: 1905px; align-self: center; margin-top: 4px; margin-bottom: 4px; transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div><div contenteditable="false" data-content-editable-void="true"><div aria-labelledby=":rd:" role="figure"><div style="display: flex; width: fit-content;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative; border-radius: 10px;"><div><div class="" style="width: 100%; height: 100%;"><img alt="" referrerpolicy="same-origin" src="5a5da91d2c847a01c613b7474b8345b7336bbf52.png" style="display: block; object-fit: cover; border-radius: 2px; height: 804.292px; pointer-events: auto; width: 100%; max-height: 804.292px;"/></div></div></div><div style="left: 0px; top: 0px; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); pointer-events: none; opacity: 0; position: absolute; transition: opacity 100ms ease-in-out;"></div></div></div></div></div></div></div><div class="notion-selectable notion-sub_header-block" data-block-id="2cc425cc-edaa-80f8-94b5-f45a01c7c7c6" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1.4em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h3 class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 2" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.5em; line-height: 1.3; margin: 0px;">DualPipeV</h3><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2d9425cc-edaa-80f2-9882-fadae1ea1a09" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">A slight modification for even better throughput, which further increases overlap by introducing <span class="notion-enable-hover" data-token-index="1" style="font-weight:600">finer-grained</span> stream separation. Instead of using a single forward stream and a single backward stream, computation is divided across multiple “virtual” streams, allowing more granular overlap between forward computation, backward computation and communication.</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="2d9425cc-edaa-80d2-9ee7-f338a691c877" dir="ltr" style="width: 100%; max-width: 1905px; align-self: center; margin-top: 4px; margin-bottom: 4px; transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div><div contenteditable="false" data-content-editable-void="true"><div aria-labelledby=":re:" role="figure"><div style="display: flex; width: fit-content;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative; border-radius: 10px;"><div><div class="" style="width: 100%; height: 100%;"><img alt="" referrerpolicy="same-origin" src="04ba9393027921571aac2dad39f632458e52ad26.png" style="display: block; object-fit: cover; border-radius: 2px; height: 355px; pointer-events: auto; width: 100%; max-height: 355px;"/></div></div></div><div style="left: 0px; top: 0px; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); pointer-events: none; opacity: 0; position: absolute; transition: opacity 100ms ease-in-out;"></div></div></div></div></div></div></div><div class="notion-selectable notion-sub_header-block" data-block-id="2d9425cc-edaa-80d3-8f18-defda8476c71" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1.4em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h3 class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 2" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.5em; line-height: 1.3; margin: 0px;">Notes &amp; Abstractions</h3><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2d9425cc-edaa-8037-9527-e2b26f00b2e5" dir="auto" style="width: 100%; max-width: 1713px; margin-top: 1px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="content-editable-leaf-rtl" contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">A few abstractions are made throughout this blog, that is important to explicitly mention. Other than the already mentioned optimizer state, the main one concerns communication operations, which are treated abstractly in the text. In practice these operations are executed on <span class="notion-enable-hover" data-token-index="1" style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:inherit;text-underline-offset:10%;color:inherit;word-wrap:break-word">separate, dedicated CUDA streams</span> and handled by a backend communication library (most commonly NCCL), a detail that is largely consistent across all the distributed training setups discussed here. This abstraction allows the discussion to primarily focus on execution order, dependencies and overlap opportunities rather.</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div></div><span data-content-editable-root-tiny-selection-trap="true" style="height: 1px; width: 1px; caret-color: transparent;"></span></div><div class="notion-presence-container" style="position: absolute; top: 0px; inset-inline-start: 0px; z-index: 89;"><div></div></div><div class="sticky-portal-target" data-sticky-stack-name="default" style="position: sticky; z-index: 85; width: 100%; bottom: 0px; inset-inline-start: 0px; flex: 0 1 0%;"></div></div></div></main><div aria-hidden="true" aria-label="Side Peek" class="notion-peek-renderer" role="region" style="position: absolute; top: 0px; inset-inline-end: 0px; bottom: 0px; width: 960px; z-index: 109; transform: translateX(calc(var(--direction, 1) * 960px)) translateZ(0); transition-duration: 200ms; transition-timing-function: ease; transition-property: width, transform;"></div></div></div></div><div style="display: block; position: fixed; visibility: hidden; overflow-y: scroll; width: 20px; height: 20px;"></div></div></div></div></body></html>
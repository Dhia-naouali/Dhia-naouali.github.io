<html class="notion-html" data-notion-html="web" data-notion-version="23.13.20251130.0252" lang="en" style="--full-viewport-height: 19861px; --direction: 1;"><head lang="en">
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WLFCL5GRMY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-WLFCL5GRMY');
</script>
  <meta charset="utf-8"/><meta content="width=device-width,height=device-height,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" name="viewport"/><title>JAX: Jit Autograd XLA</title><meta content="en_US" property="og:locale"/><meta content="yes" name="mobile-web-app-capable"/><meta content="app-id=1232780281" property="apple-itunes-app"/><link href="https://bittersweet-yarn-df1.notion.site/images/favicon.ico" rel="shortcut icon" type="image/x-icon"/><link href="/images/logo-ios.png" rel="apple-touch-icon"/><meta content="telephone=no" name="format-detection"/><meta content="no" name="msapplication-tap-highlight"/><link href="4e8dd02ae0f74049b708c079bcd1feb979cff37d.css" media="print" rel="stylesheet"/><style>body{background:#fff}body.dark{background:#191919}@keyframes startup-shimmer-animation{0%{transform:translateX(-100%) translateZ(0)}100%{transform:translateX(100%) translateZ(0)}}@keyframes startup-shimmer-fade-in{0%{opacity:0}100%{opacity:1}}@keyframes startup-spinner-rotate{0%{transform:rotate(0) translateZ(0)}100%{transform:rotate(360deg) translateZ(0)}}#initial-loading-spinner{position:fixed;height:100vh;width:100vw;z-index:-1;display:none;align-items:center;justify-content:center}#initial-loading-spinner .spinner{position:relative;display:inline-block;height:22px;width:22px;pointer-events:none}#initial-loading-spinner .spinner__circle{position:absolute;top:0;left:0;width:22px;height:22px;border-radius:50%;border:2px solid rgba(28,19,1,.11)}.dark #initial-loading-spinner .spinner__circle{border-color:rgba(255,255,235,.1)}#initial-loading-spinner .spinner__arc{position:absolute;top:0;left:0;width:22px;height:22px;border-radius:50%;border-top:2px solid #30302e;border-right:2px solid #30302e;border-bottom:2px solid transparent;border-left:2px solid transparent;mask:linear-gradient(90deg,transparent 66.66%,#000 66.66%);animation:startup-spinner-rotate 1.2s linear infinite}.dark #initial-loading-spinner .spinner__arc{border-color:#f0efed}#skeleton{background:#fff;position:fixed;height:100vh;width:100vw;z-index:-1;display:none;overflow:hidden}#initial-loading-spinner.show,#skeleton.show{display:flex}body.dark #skeleton{background:#191919}.notion-front-page #skeleton,.notion-mobile #skeleton{display:none}#skeleton-sidebar{background-color:#f9f8f7;box-shadow:inset calc(var(--direction,1) * -1px) 0 0 0 #eeeeec;display:flex;width:240px;flex-direction:column;padding:12px 14px;overflow:hidden}body.dark #skeleton-sidebar{background-color:#202020;box-shadow:inset calc(var(--direction,1) * -1px) 0 0 0 #2a2a2a}#skeleton.isElectron #skeleton-sidebar{padding-top:46px}#skeleton .row{display:flex;margin-bottom:11px;align-items:center}#skeleton .row.fadein{animation:1s ease-in 0s 1 normal both running startup-shimmer-fade-in}#skeleton .chevron{width:12px;height:12px;display:block;margin-right:4px;fill:rgba(227,226,224,.5)}body.dark #skeleton .chevron{fill:#2f2f2f}.startup-shimmer{background:rgba(227,226,224,.5);overflow:hidden;position:relative}body.dark .startup-shimmer{background:#2f2f2f}.startup-shimmer::before{content:"";position:absolute;height:100%;width:100%;z-index:1;animation:1s linear infinite startup-shimmer-animation;background:linear-gradient(90deg,rgba(0,0,0,0) 0,rgba(0,0,0,.03) 50%,rgba(0,0,0,0) 100%)}body.dark .startup-shimmer::before{background:linear-gradient(90deg,transparent 0,rgba(86,86,86,.1) 50%,transparent 100%)}#skeleton .icon{width:20px;height:20px;border-radius:4px}#skeleton .text{height:10px;border-radius:10px}#skeleton .draggable{-webkit-app-region:drag;position:absolute;top:0;left:0;width:100%;height:36px;display:none}#skeleton.isElectron .draggable{display:block}</style><link href="a3b7821a2dcd0ea1fed9dd980313b74b6d955b28.css" rel="stylesheet"/><link href="4e546d47f94b085ffaaf1260a576311dfb4fe0ad.css" rel="stylesheet" type="text/css"/><link href="628c8fc7905073af3408adab70c480c0b601ee8e.css" rel="stylesheet" type="text/css"/><link href="8fd257a4c299589199d1d7d5b3ffeb6e208f075a.css" rel="stylesheet" type="text/css"/><style>


		
		
		.assistant-grouped-edit-chat-container .assistant-grouped-edit-insert {
			background: initial !important;
			border-bottom: initial !important;
			color: var(--c-texPri) !important;
		}

		.assistant-grouped-edit-chat-container .assistant-grouped-edit-remove {
			background: initial !important;
			border-bottom: initial !important;
			color: var(--c-texDis) !important;
		}
	
<style>
.notion-topbar { display: none !important; }
.notion-frame { padding-left: 3rem !important; }
<style>
.notion-topbar { display: none !important; }
.notion-frame { padding-left: 3rem !important; }
</style></style>	</style><link href="aa4af630f8206694204f498d9b3ba4cc2b517f5c.css" rel="stylesheet" type="text/css"/><meta content="noindex" name="robots"/><link href="/JAX-Jit-Autograd-XLA-2590b1a776e180eda44dcf30931a18de" rel="canonical"/><link href="e1d809d762eeca23edf0cb31bb17bf3c703085f5.css" rel="stylesheet"/><link href="58deccad03ab320749215a65df251e0d3ba21702.css" rel="stylesheet" type="text/css"/></head><body class="notion-body"><noscript><style>.main{display:flex;justify-content:center;align-items:center;height:100vh;background:#fffefc;color:#37352f;line-height:1.5;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,"Apple Color Emoji",Arial,sans-serif,"Segoe UI Emoji","Segoe UI Symbol";-webkit-font-smoothing:auto;text-align:center;flex-direction:column;margin:0;padding:40px 20px 60px 20px}</style><div class="main"><img alt="Notion" src="84f0a28204788accc66d47bc0a4bdb4ebc96c62e.svg" style="width:40px;margin:0 auto;display:block"/><p>JavaScript must be enabled in order to use Notion.<br/>Please enable JavaScript to continue.</p></div></noscript><style id="scroll-properties">
		* {
			scrollbar-width: 15px;
			scrollbar-color: rgba(255, 255, 255, 0.2)  rgba(0, 0, 0, 0);
		}
	</style><script src="1172e9111a5fb396bcb8a05870b5eabf8abf221c.js" type="text/javascript"></script><div id="notion-app"><div class="notion-dark-theme" style="display: contents;"><div class="notion-app-inner notion-dark-theme" style='color: var(--c-texPri); fill: currentcolor; line-height: 1.5; font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; -webkit-font-smoothing: auto; background-color: var(--c-bacPri); transition: height 0.1s;'><div style="height: 100%;"><div class="notion-cursor-listener" style="width: 100vw; height: 100%; position: relative; display: flex; flex: 1 1 0%; background: var(--c-bacPri); cursor: text;"><div class="notion-print-ignore" style="height: 68px; position: fixed; top: 0px; inset-inline: 0px; bottom: 0px; z-index: 1000; width: 240px; transform: translateY(-100px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width, transform;"><a href="#main" id="skip-to-content" rel="noopener noreferrer" role="link" style="display: block; color: white; text-decoration: none; user-select: none; transition: background 20ms ease-in; cursor: pointer; position: absolute; inset-inline-start: 12px; top: 12px; width: 200px; height: 48px; overflow: hidden; z-index: 9999; padding: 12px; background: var(--cd-bluButBac); text-align: center; border-radius: 16px;"><div style="display: flex; align-items: center; justify-content: center; gap: 8px;">Skip to content<svg aria-hidden="true" class="arrowUTurnUpRightFill directional-icon" role="graphics-symbol" style="width: 20px; height: 20px; display: block; fill: inherit; flex-shrink: 0; color: inherit;" viewBox="0 0 20 20"><path d="M12.231 4.969A.875.875 0 1 1 13.47 3.73l4.4 4.4a.875.875 0 0 1 0 1.238l-4.4 4.4a.875.875 0 1 1-1.238-1.238l2.906-2.906H6a2.375 2.375 0 1 0 0 4.75h1.42a.875.875 0 0 1 0 1.75H6a4.125 4.125 0 1 1 0-8.25h9.138z"></path></svg></div></a></div><div class="" style="order: 3; display: flex; flex-direction: column; width: 100%; overflow: hidden; isolation: auto; background: transparent; position: relative;"><header style="background: var(--c-bacPri); max-width: 100vw; z-index: 100; user-select: none; position: relative;"><div class="notion-topbar" style="width: calc(100% + 0px); max-width: 100vw; height: 44px; opacity: 1; transition: opacity 700ms, color 700ms; position: relative; inset-inline-start: 0px;"><div style="display: flex; justify-content: space-between; align-items: center; overflow: hidden; height: 44px; padding-inline: 12px 10px;"><div class="notranslate shadow-cursor-breadcrumb" style="display: flex; align-items: center; line-height: 1.2; font-size: 14px; height: 100%; flex-grow: 0; margin-inline-end: 8px; min-width: 0px;"><div aria-disabled="true" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: default; display: inline-flex; align-items: center; justify-content: unset; height: 24px; padding-inline: 6px; border-radius: 6px; white-space: nowrap; font-size: 14px; font-weight: 400; line-height: 1.2; color: var(--c-texPri); flex-shrink: 1; min-width: 0px;" tabindex="-1"><div class="notranslate" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 240px;">JAX: Jit Autograd XLA</div></div></div><div style="flex-grow: 1; flex-shrink: 1;"></div><div style="display: flex; justify-content: space-between; padding-inline-start: 10px;"><div style="display: flex; align-items: center;"><div role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; display: inline-flex; align-items: center; justify-content: unset; height: 28px; padding-inline: 8px; border-radius: 6px; white-space: nowrap; font-size: 14px; font-weight: 400; line-height: 1.2; color: var(--c-texPri); flex-shrink: 0; min-width: 0px;" tabindex="0"><svg aria-hidden="true" class="magnifyingGlass" role="graphics-symbol" style="width: 22px; height: 22px; display: block; fill: inherit; flex-shrink: 0;" viewBox="0 0 20 20"><path d="M8.875 2.625a6.25 6.25 0 1 0 3.955 11.09l3.983 3.982a.625.625 0 1 0 .884-.884l-3.983-3.982a6.25 6.25 0 0 0-4.84-10.205m-5 6.25a5 5 0 1 1 10 0 5 5 0 0 1-10 0"></path></svg></div><div data-popup-origin="true" style="display: contents;"><div data-popup-origin="true" style="display: contents;"><div aria-expanded="false" aria-haspopup="dialog" aria-label="Share site to socials" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; display: inline-flex; align-items: center; justify-content: unset; height: 28px; padding-inline: 8px; border-radius: 6px; white-space: nowrap; font-size: 14px; font-weight: 400; line-height: 1.2; color: var(--c-texPri); flex-shrink: 0; min-width: 0px;" tabindex="0"><svg aria-hidden="true" class="squareAndArrowUp" role="graphics-symbol" style="width: 22px; height: 22px; display: block; fill: inherit; flex-shrink: 0;" viewBox="0 0 20 20"><path d="M9.533.62a.625.625 0 0 1 .884 0l2.5 2.5a.625.625 0 1 1-.884.884l-1.408-1.408V11a.625.625 0 1 1-1.25 0V2.546L7.917 4.004a.625.625 0 1 1-.884-.883z"></path><path d="M8.125 5.125H5.5A2.125 2.125 0 0 0 3.375 7.25v7.5c0 1.174.951 2.125 2.125 2.125h9a2.125 2.125 0 0 0 2.125-2.125v-7.5A2.125 2.125 0 0 0 14.5 5.125h-2.625v1.25H14.5c.483 0 .875.392.875.875v7.5a.875.875 0 0 1-.875.875h-9a.875.875 0 0 1-.875-.875v-7.5c0-.483.392-.875.875-.875h2.625z"></path></svg></div></div></div><div data-popup-origin="true" style="display: contents;"><div role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; display: inline-flex; align-items: center; justify-content: unset; height: 28px; padding-inline: 8px; border-radius: 6px; white-space: nowrap; font-size: 14px; font-weight: 400; line-height: 1.2; color: var(--c-texPri); flex-shrink: 0; min-width: 0px;" tabindex="0"><svg aria-hidden="true" class="duplicate" role="graphics-symbol" style="width: 22px; height: 22px; display: block; fill: inherit; flex-shrink: 0;" viewBox="0 0 20 20"><path d="M4.5 2.375A2.125 2.125 0 0 0 2.375 4.5V12c0 1.174.951 2.125 2.125 2.125h1.625v1.625c0 1.174.951 2.125 2.125 2.125h7.5a2.125 2.125 0 0 0 2.125-2.125v-7.5a2.125 2.125 0 0 0-2.125-2.125h-1.625V4.5A2.125 2.125 0 0 0 12 2.375zm8.375 3.75H8.25A2.125 2.125 0 0 0 6.125 8.25v4.625H4.5A.875.875 0 0 1 3.625 12V4.5c0-.483.392-.875.875-.875H12c.483 0 .875.392.875.875zm-5.5 2.125c0-.483.392-.875.875-.875h7.5c.483 0 .875.392.875.875v7.5a.875.875 0 0 1-.875.875h-7.5a.875.875 0 0 1-.875-.875z"></path></svg></div></div><div data-popup-origin="true" style="display: contents;"><div aria-expanded="false" aria-haspopup="dialog" aria-label="More actions" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; display: flex; align-items: center; justify-content: center; width: 32px; height: 28px; border-radius: 4px;" tabindex="0"><svg aria-hidden="true" class="ellipsis" role="graphics-symbol" style="width: 22px; height: 22px; display: block; fill: inherit; flex-shrink: 0; color: inherit;" viewBox="0 0 20 20"><path d="M4 11.375a1.375 1.375 0 1 0 0-2.75 1.375 1.375 0 0 0 0 2.75m6 0a1.375 1.375 0 1 0 0-2.75 1.375 1.375 0 0 0 0 2.75m6 0a1.375 1.375 0 1 0 0-2.75 1.375 1.375 0 0 0 0 2.75"></path></svg></div></div><div role="button" style="user-select: none; transition: background 0.1s ease-in-out; cursor: pointer; display: inline-flex; align-items: center; justify-content: center; height: 32px; padding-inline: 12px; border-radius: 6px; white-space: nowrap; font-size: 14px; font-weight: 500; line-height: 1.2; flex-shrink: 0; background: var(--c-bacAccPri); color: var(--c-texInvPri); fill: var(--c-texInvPri); padding: 0px 10px; margin-inline-start: 8px;" tabindex="0">Get Notion free</div></div></div></div></div></header><main class="notion-frame" id="main" style="flex-grow: 0; flex-shrink: 1; display: flex; flex-direction: column; background: var(--c-bacPri); z-index: 1; height: calc(-44px + 100vh); max-height: 100%; position: relative; padding-bottom: 0px; width: 1920px; transform: translateX(calc(var(--direction, 1) * 0px)); transition-duration: 200ms; transition-timing-function: ease; transition-property: width, transform;"><div class="notion-selectable-container" style="display: contents;"><div class="notion-scroller vertical" style="z-index: 1; display: flex; flex-direction: column; flex-grow: 1; position: relative; align-items: center; overflow: hidden auto;"><div class="sticky-portal-target" data-sticky-stack-name="default" style="position: sticky; z-index: 85; width: 100%; top: 0px; inset-inline-start: 0px; height: 0px; flex: 0 1 0%;"></div><div style="position: absolute; top: 0px; inset-inline-start: 0px; z-index: 99;"><div class="notion-selectable-hover-menu-item"></div></div><div aria-disabled="true" aria-label="Start typing to edit text" aria-multiline="true" class="whenContentEditable" data-content-editable-root="true" role="textbox" style="caret-color: var(--c-texPri); width: 100%; display: flex; flex-direction: column; position: relative; align-items: center; flex-grow: 1; --whenContentEditable--WebkitUserModify: read-write-plaintext-only;"><span data-content-editable-root-tiny-selection-trap="true" style="height: 1px; width: 1px; caret-color: transparent; margin-top: -1px;"></span><div class="layout layout-wide" style="padding-bottom: 30vh; transform: translateX(calc(var(--direction, 1) * 0px)); transition-duration: 200ms; transition-timing-function: ease; transition-property: transform;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" style="user-select: none; --pseudoSelection--background: transparent; display: contents;"><div class="layout-margin-right" style="width: 100%; grid-row: 1 / -1; padding-inline-start: 0px; position: sticky; top: 0px; inset-inline-end: 0px; z-index: 80; transition: opacity 0.2s; opacity: 1; visibility: visible; pointer-events: none;"><div style="width: 100%; height: 0px;"></div><div class="hide-scrollbar ignore-scrolling-container notion-floating-table-of-contents" style="position: absolute; top: 0px; width: 100%; height: calc(-44px + 100vh); display: flex; flex-direction: column; pointer-events: none;"><div style="display: flex;"><div contenteditable="false" data-content-editable-void="true" style="width: 100%;"><div style="max-height: 19419px; margin-bottom: 60px; pointer-events: auto;"><div style="max-height: 400px; display: flex; flex-direction: row; position: absolute; top: 318px; inset-inline-end: 0px; overflow-y: hidden; opacity: 1; transition-duration: 200ms; transition-timing-function: ease; transition-property: opacity;"><div style="width: 56px; display: flex; flex-direction: column; justify-content: center; padding-bottom: 12px; padding-inline-end: 8px;"><div style="display: flex; flex-direction: column; gap: 12px; padding-inline-start: 20px; padding-bottom: 12px; height: 100%;"><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 8px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 8px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 8px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 8px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 8px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 8px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 8px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 8px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 16px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 0px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--c-palGra800); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: 0px 0px 3px var(--c-palGra800); border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div><div><div style="background-color: var(--ca-graBacTerTra); height: 2px; width: 12px; transition: background 0.2s, box-shadow 0.2s; box-shadow: none; border-radius: 2px; margin-inline-start: 4px;"></div></div></div></div></div></div></div></div></div></div></div><div class="layout-full" style="isolation: isolate;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" style="user-select: none; --pseudoSelection--background: transparent; width: 100%; display: flex; flex-direction: column; align-items: center; flex-shrink: 0; flex-grow: 0; z-index: 2; transform: translateX(calc(var(--direction, 1) * 0px)); transition-duration: 200ms; transition-timing-function: ease; transition-property: transform;"><div style="position: relative; width: 100%; z-index: 1; display: flex; flex-direction: column; align-items: center; height: 30vh; max-height: 280px; cursor: default;"><div style="width: 100%; cursor: default;"><div style="display: grid; width: 100%; height: 30vh; max-height: 280px;"><div class="" style="grid-area: 1 / 1; width: 100%; height: 100%;"><img alt="" referrerpolicy="same-origin" src="9a1d1ddded20970fcead776272c24accbc92250d.png" style="display: block; object-fit: cover; border-radius: 0px; width: 100%; height: 30vh; max-height: 280px; opacity: 1; object-position: center 50%;"/></div></div></div></div></div></div><div class="layout-content" style="margin-inline-start: -4px;"><div style="width: 100%; display: flex; flex-direction: column; align-items: center; flex-shrink: 0; flex-grow: 0;"><div style="max-width: 100%; padding-inline-start: calc(0px + env(safe-area-inset-left)); width: 100%;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" style="user-select: none; --pseudoSelection--background: transparent; pointer-events: none;"><div style="display: flow-root; pointer-events: auto;"></div><div><div class="notion-page-controls" style='display: flex; padding-top: 16px; padding-bottom: 4px; justify-content: flex-start; flex-wrap: wrap; margin-inline-start: -1px; color: var(--c-texTer); font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; pointer-events: auto;'></div></div></div><div style="padding-inline-end: calc(0px + env(safe-area-inset-right));"><div><div class="notion-selectable notion-page-block" data-block-id="2590b1a7-76e1-80ed-a44d-cf30931a18de" style="color: var(--c-texPri); font-weight: 700; line-height: 1.2; font-size: 32px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; cursor: default; display: flex; align-items: center;"><h1 contenteditable="false" data-content-editable-leaf="true" placeholder="New page" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 0px; padding-inline: 2px; font-size: 1em; font-weight: inherit; margin: 0px; cursor: default;">JAX: Jit Autograd XLA</h1><div contenteditable="false" data-content-editable-void="true"></div></div><div contenteditable="false" data-content-editable-void="true" style="margin-inline-start: 4px;"></div></div></div></div></div></div><div class="layout-content" style="margin-inline-start: -2px; margin-top: 8px;"><div class="notion-page-content" style="flex-shrink: 0; flex-grow: 1; max-width: 100%; display: flex; align-items: flex-start; flex-direction: column; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-size: 14px; letter-spacing: 0.055em; line-height: 1.6; width: 100%; z-index: 4; padding-top: 8px; padding-bottom: 0px; padding-inline: 0px;"><div class="notion-selectable notion-divider-block" data-block-id="2590b1a7-76e1-8075-aab2-f40d7a3ef9e2" style="width: 100%; max-width: 1713px; margin-top: 2px; margin-bottom: 1px;"><div class="notion-cursor-default" style="display: flex; align-items: center; justify-content: center; pointer-events: auto; width: 100%; height: 13px; flex: 0 0 auto;"><div role="separator" style="width: 100%; height: 1px; visibility: visible; border-bottom: 1px solid var(--ca-borPriTra);"></div></div></div><div class="notion-selectable notion-column_list-block" data-block-id="2590b1a7-76e1-805f-978b-d2f09973e116" style="width: 100%; max-width: 1713px; align-self: center; margin-top: 1px; margin-bottom: 0px;"><div style="display: flex;"><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(50% - 23px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="2590b1a7-76e1-800d-bb29-cacb33743a6a" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-header-block" data-block-id="2590b1a7-76e1-80b4-8100-d41f4b31d6a1" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;">Array</h2><div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="25a0b1a7-76e1-80ec-ab08-dee5a65154d5" style="width: 100%; max-width: 100%; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h4 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.25em; line-height: 1.3; margin: 0px;">Attributes</h4><div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25a0b1a7-76e1-807c-b9ef-d7b633a9931d" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">devices(): storing device</div><div></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25a0b1a7-76e1-80e4-8928-ce6fba449b07" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">sharding: (distributed?) location</div><div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80fc-af15-f026da97597d" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div></div></div></div></div><div class="notion-selectable notion-sub_header-block" data-block-id="25a0b1a7-76e1-805e-a971-db5dc570ce54" style="width: 100%; max-width: 100%; margin-top: 1.4em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h3 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 2" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.5em; line-height: 1.3; margin: 0px;">Types promotion</h3><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8096-a094-df3c19f4d609" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">unlike <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>numpy</span></div>, <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="3" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.numpy</span></div> doesn’t promote <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="5" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>float64</span></div> for efficiency and compatibility (TPUs), it does also support <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="7" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>bfloat16</span></div></div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-803c-b7a8-f002262097af" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">use <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.config.update('jax_numpy_dtype_promotion', 'strict')</span></div> to disable implicit type promotion (still allows python scalars type promotion for convenience)</div><div></div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="25b0b1a7-76e1-8081-a4d9-f40e7f178805" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;"><span class="notion-enable-hover" data-token-index="0" style="font-weight:600">Transformations</span></h2><div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="25a0b1a7-76e1-8004-a9a2-f9b0f20f225c" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;">Jit</h2><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-800a-9807-cbbcb93ad11f" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">wrap input args → record all operations</div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-80fd-abe7-e42d8c747179" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">ns → produce a jaxpr using the tracer records</div><div></div></div></div></div><div class="notion-selectable notion-table-block" data-block-id="25b0b1a7-76e1-80d8-93c4-e08ff446145a" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div><div contenteditable="false" data-content-editable-void="true" style="color: inherit; fill: inherit; position: relative; display: flex;"><div class="notion-selectable notion-table-block" data-block-id="25b0b1a7-76e1-80d8-93c4-e08ff446145a" style="width: 100%; position: relative; align-self: center; max-width: 100%;"><div class="notion-scroller horizontal" style="z-index: 1; flex-grow: 1; padding-inline-start: 20px; margin-inline-start: -20px; overflow: auto hidden;"><div class="notion-table-content" style="padding-inline-end: 20px;"><div style="display: flex;"><div style="padding-top: 8px; padding-bottom: 24px; padding-inline-end: 24px;"><div class="notion-selectable notion-table-block notion-table-tbody-selectable" data-block-id="25b0b1a7-76e1-80d8-93c4-e08ff446145a" style="position: relative;"><div><table style="isolation: auto;"><tbody style="isolation: auto;"><tr class="notion-table-row" style="isolation: auto;"><td style="color: inherit; fill: inherit; border: 1px solid var(--c-tabDivCol); isolation: auto; position: relative; vertical-align: top; text-align: start; min-width: 287px; max-width: 287px; min-height: 32px;"><div class="notion-table-cell" style="isolation: auto;"><div aria-label="Start typing to edit text" class="notion-table-cell-text" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding: 7px 9px; background-color: transparent; font-size: 12px; line-height: 20px;" tabindex="0"><span class="notion-enable-hover" data-token-index="0" style="font-weight:600">with jit</span></div></div></td><td style="color: inherit; fill: inherit; border: 1px solid var(--c-tabDivCol); isolation: auto; position: relative; vertical-align: top; text-align: start; min-width: 290px; max-width: 290px; min-height: 32px;"><div class="notion-table-cell" style="isolation: auto;"><div aria-label="Start typing to edit text" class="notion-table-cell-text" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding: 7px 9px; background-color: transparent; font-size: 12px; line-height: 20px;" tabindex="0"><span class="notion-enable-hover" data-token-index="0" style="font-weight:600">without jit</span></div></div></td></tr><tr class="notion-table-row" style="isolation: auto;"><td style="color: inherit; fill: inherit; border: 1px solid var(--c-tabDivCol); isolation: auto; position: relative; vertical-align: top; text-align: start; min-width: 287px; max-width: 287px; min-height: 32px;"><div class="notion-table-cell" style="isolation: auto;"><div aria-label="Start typing to edit text" class="notion-table-cell-text" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding: 7px 9px; background-color: transparent; font-size: 12px; line-height: 20px;" tabindex="0">jaxpr operations passed all at once as a graph / sequence</div></div></td><td style="color: inherit; fill: inherit; border: 1px solid var(--c-tabDivCol); isolation: auto; position: relative; vertical-align: top; text-align: start; min-width: 290px; max-width: 290px; min-height: 32px;"><div class="notion-table-cell" style="isolation: auto;"><div aria-label="Start typing to edit text" class="notion-table-cell-text" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding: 7px 9px; background-color: transparent; font-size: 12px; line-height: 20px;" tabindex="0">operations are passed one by one as being interpreted</div></div></td></tr></tbody></table></div></div></div></div></div></div></div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80b1-a4a1-df41906de07f" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">traces a function during the first call, wrap objects &amp; functions in <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>Traced&lt;…&gt;</span></div> and keep track of shapes, types (like graph guards in torch compile) to produce operations that can be passed to <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="3" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>XLA</span></div> to compute</div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8084-a87b-eca1897f2f61" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.make_jaxpr</span></div> can be used to extract the produced sequence of operations </div><div></div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="25a0b1a7-76e1-80cf-a9f0-dbb0f95f829a" style="width: 100%; max-width: 100%; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h4 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.25em; line-height: 1.3; margin: 0px;">static args</h4><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8033-8b9f-e6c46352bc6b" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">static operations are evaluated at compile-time in python</div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80b6-940e-f4ab9dac62d3" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">traced operations are evaluated at run-tim in XLA </div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8070-a5a0-cca055153b73" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">arguments to be used in control flow should be flagged as static using <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>static_argnums=(static_arg_pos, )</span></div> </div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-8020-b3ea-ddc55f5c8738" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">or <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>static_argname=("arg_names",)</span></div> </div><div></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="25a0b1a7-76e1-8091-b882-f41715487701" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div aria-labelledby=":r2:" contenteditable="false" data-content-editable-void="true" role="figure" style="flex-grow: 1; text-align: start; position: relative; min-width: 0px; width: 100%; border-radius: 10px;"><div style="background: var(--ca-graBacPriTra); border-radius: 10px;"><div style="padding: 24px 22px;"><div class="line-numbers notion-code-block" style="display: flex; padding: 12px 0px; overflow-x: auto;"><div aria-label="Start typing to edit text" autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: start; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; min-height: 1em; color: var(--c-texPri); white-space: pre;' tabindex="0"><span class="token comment" data-token-index="0"># @partial(jit, static_argnums=(1,))</span><span class="" data-token-index="0">
</span><span class="token keyword" data-token-index="0">def</span><span class="" data-token-index="0"> </span><span class="token function" data-token-index="0">f</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">x</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> y</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">:</span><span class="" data-token-index="0">
	</span><span class="token keyword" data-token-index="0">return</span><span class="" data-token-index="0"> x</span><span class="token operator" data-token-index="0">*</span><span class="token number" data-token-index="0">2</span><span class="" data-token-index="0"> </span><span class="token keyword" data-token-index="0">if</span><span class="" data-token-index="0"> y </span><span class="token keyword" data-token-index="0">else</span><span class="" data-token-index="0"> x

double </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> </span><span class="token boolean" data-token-index="0">True</span><span class="" data-token-index="0">
jax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">jit</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">f</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> static_argnums</span><span class="token operator" data-token-index="0">=</span><span class="token punctuation" data-token-index="0">(</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">,</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">x</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> double</span><span class="token punctuation" data-token-index="0">)</span><span>
</span></div></div></div></div><div dir="auto" style="padding-inline-end: 105px;"></div></div>​<div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="25b0b1a7-76e1-8079-aec2-c782bd0fa9d8" style="width: 100%; max-width: 100%; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h4 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.25em; line-height: 1.3; margin: 0px;">compiled func caching</h4><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-8096-9f8f-f1eaa8b8c077" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.jit</span></div> decorator cache a compiled version of the function using it’s hash code, that as long as the traced inputs have the same type, shape will be used, else func will be recompiled and cached</div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-807c-96d1-f24d4c0160f1" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">when a jitted function is decorated with <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.jit</span></div> the cached version of the inner function will be used</div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-807e-8009-e2ff0e5db80d" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-80df-9245-ec1b0e71c8f6" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">avoid producing a new hash each call</div><div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25b0b1a7-76e1-80d0-bed4-fdcff19cbad6" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">partial(function)</div><div></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25b0b1a7-76e1-8066-b28c-eee636a0f5df" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">lambda function</div><div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-808a-bb71-efee98b2ca18" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"> </div><div></div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="25a0b1a7-76e1-8000-9738-ff062a4b0f66" style="width: 100%; max-width: 100%; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h4 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.25em; line-height: 1.3; margin: 0px;">implicit, unwanted behaviors</h4><div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25a0b1a7-76e1-8066-a7f1-c6959439a72d" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">if a global var is passed, jit will hard trace its value, (subsequent changes won’t reflect in runs from the cached compilation)</div><div></div></div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="25a0b1a7-76e1-80ec-bdb5-e0d18edd7cdd" style="width: 100%; max-width: 100%; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h4 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.25em; line-height: 1.3; margin: 0px;">notes</h4><div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25a0b1a7-76e1-804b-b85a-d8980dec159f" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">struggle with control flows: if, while, …</div><div></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25a0b1a7-76e1-80ba-bd07-c34956bde0eb" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">pure functions only: static shapes, no global vars, deterministic</div><div></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25a0b1a7-76e1-80fe-b68a-f421ac0fe8c1" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">operations fusion</div><div></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25a0b1a7-76e1-807e-9a3e-ca72d1f12877" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">avoid temporary allocation (local mem ←x→ global mem)</div><div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2780b1a7-76e1-80cb-bf1a-d8c4b459556e" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div></div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="2780b1a7-76e1-80a6-871a-db2c98bbc2ea" style="width: 100%; max-width: 100%; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h4 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.25em; line-height: 1.3; margin: 0px;">donated args</h4><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2780b1a7-76e1-8007-849d-e071a627cd6d" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">arguments passed to a jitted function can be “dnoated” i.e we use the same device memory allocated for the input values of that argument to store the output / updated value (post func)</div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2780b1a7-76e1-80aa-b615-f99a94054078" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div></div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="2780b1a7-76e1-805f-8169-fe1b6955dd18" style="width: 100%; max-width: 100%; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h4 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.25em; line-height: 1.3; margin: 0px;">Tracing shapes with no comp</h4><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2780b1a7-76e1-803a-a696-ca32695f8a04" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">using <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.eval_shape</span></div> we can trace inputs to figure out shapes (useful to avoid compiling twice when one of the arguments will start as None then will be an array)</div><div></div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="25a0b1a7-76e1-80d4-8e07-cb5ea94d1318" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;">Auto-diff</h2><div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="25a0b1a7-76e1-80fe-ba7e-e3400daf37b5" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>#jax.grad</span></div> </h2><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8084-ab74-ceaee8c05a7a" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.grad</span></div> trace and transform a given function <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="2" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>f</span></div>  and return a function that given a set of inputs, differentiate <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="4" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>f</span></div> w.r.t to the first one </div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-80b9-a66b-fa9ef88518ea" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">by default a <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.grad</span></div> transformed function compute the gradient of it’s first argument (<div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="3" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jnp.array</span></div> or <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="5" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>PyTree</span></div>) by  tracing all operations inside that function</div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-80c6-9010-fecab9a66c9d" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.value_and_grad</span></div> is similar to grad, but evaluate the function &amp; it’s grad</div><div></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="25b0b1a7-76e1-8035-99b0-d8f69bbf4584" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div aria-labelledby=":re:" contenteditable="false" data-content-editable-void="true" role="figure" style="flex-grow: 1; text-align: start; position: relative; min-width: 0px; width: 100%; border-radius: 10px;"><div style="background: var(--ca-graBacPriTra); border-radius: 10px;"><div style="padding: 24px 22px;"><div class="line-numbers notion-code-block" style="display: flex; padding: 12px 0px; overflow-x: auto;"><div aria-label="Start typing to edit text" autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: start; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; min-height: 1em; color: var(--c-texPri); white-space: pre;' tabindex="0"><span class="" data-token-index="0">y</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> dfdx </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> jax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">value_and_grad</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">f</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">x</span><span class="token punctuation" data-token-index="0">)</span><span>
</span></div></div></div></div><div dir="auto" style="padding-inline-end: 105px;"></div></div>​<div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="25a0b1a7-76e1-80fa-bdef-d770d1096e34" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>#jax.jacobian</span></div> </h2><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8094-a5f1-f55861195079" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.jacobian</span></div> is similar to <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="2" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.grad</span></div> but operate on vector valued functions </div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8068-8f80-e65fffb03381" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div></div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="25a0b1a7-76e1-8083-936d-f9fe8390b773" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>#jax.jvp</span></div></h2><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80f3-baba-e26dcc4036be" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">forward mode auto-diff to compute the <span class="notion-enable-hover" data-token-index="1" style="font-weight:600">Jacobian vector product</span></div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80b0-a302-e9cff6efaee7" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">i.e:  directional derivative along an input vector <span class="notion-enable-hover" data-token-index="1" style="font-weight:600">v</span></div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80ee-9620-daca7428cdc2" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><span class="notion-enable-hover" data-token-index="0" style="font-weight:600">v</span> is a tangent vector in input space</div><div></div></div></div></div><div class="notion-selectable notion-column_list-block" data-block-id="25a0b1a7-76e1-802e-9a09-e51c236bec94" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex;"><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(50% - 23px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="25a0b1a7-76e1-80bf-a7af-f4b23e8430c4" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-code-block" data-block-id="25a0b1a7-76e1-802f-b72a-d957d3743b9a" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div aria-labelledby=":ri:" contenteditable="false" data-content-editable-void="true" role="figure" style="flex-grow: 1; text-align: start; position: relative; min-width: 0px; width: 100%; border-radius: 10px;"><div style="background: var(--ca-graBacPriTra); border-radius: 10px;"><div style="padding: 24px 22px;"><div class="line-numbers notion-code-block" style="display: flex; padding: 12px 0px; overflow-x: auto;"><div aria-label="Start typing to edit text" autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: start; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; min-height: 1em; color: var(--c-texPri); white-space: pre;' tabindex="0"><span class="" data-token-index="0">y</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> jvp </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> jax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">jvp</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">f</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">x</span><span class="token punctuation" data-token-index="0">,</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">v</span><span class="token punctuation" data-token-index="0">,</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span>
</span></div></div></div></div><div dir="auto" style="padding-inline-end: 105px;"></div></div>​<div></div></div></div><div class="notion-selectable notion-equation-block" data-block-id="25a0b1a7-76e1-80a1-b413-fd86dba0871f" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div contenteditable="false" data-content-editable-void="true" style="display: flex; position: relative;"><div data-popup-origin="true" style="display: contents;"><div aria-expanded="false" aria-haspopup="dialog" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; position: relative; width: 100%; border-radius: 10px;" tabindex="0"><div style="display: flex; padding: 4px 8px; width: 100%; flex-direction: column; overflow: auto; color: inherit; fill: inherit;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"></mspace><mrow><mi mathvariant="normal">j</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">p</mi></mrow><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi mathvariant="normal">J</mi><mi>f</mi></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi><mi mathvariant="bold">v</mi><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">y = f(x), \quad \mathrm{jvp}(\mathbf{v}) = \mathrm{J}_f(X).\mathbf{v} \\
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">jvp</span></span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathrm">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mord">.</span><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="mspace newline"></span></span></span></span></div></div></div><div></div></div></div></div></div><div style="position: relative; width: 46px; flex-grow: 0; flex-shrink: 0; transition: opacity 200ms ease-out; opacity: 0;"></div><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(50% - 23px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="25a0b1a7-76e1-8099-bb7c-f481b2ef425f" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-equation-block" data-block-id="25a0b1a7-76e1-80d5-81be-e37b3fbd4ebf" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div contenteditable="false" data-content-editable-void="true" style="display: flex; position: relative;"><div data-popup-origin="true" style="display: contents;"><div aria-expanded="false" aria-haspopup="dialog" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; position: relative; width: 100%; border-radius: 10px;" tabindex="0"><div style="display: flex; padding: 4px 8px; width: 100%; flex-direction: column; overflow: auto; color: inherit; fill: inherit;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">J</mi><mi>f</mi></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">[</mo><mtable columnalign="center center center" columnspacing="1em" rowspacing="0.16em"><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>f</mi><mn>1</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>1</mn></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>f</mi><mn>1</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>2</mn></msub></mrow></mfrac></mrow></mstyle></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mo lspace="0em" rspace="0em">⋯</mo></mstyle></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>f</mi><mn>1</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>n</mi></msub></mrow></mfrac></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>f</mi><mn>2</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>1</mn></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>f</mi><mn>2</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>2</mn></msub></mrow></mfrac></mrow></mstyle></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mo lspace="0em" rspace="0em">⋯</mo></mstyle></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>f</mi><mn>1</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>n</mi></msub></mrow></mfrac></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mrow><mrow><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace height="1.5em" mathbackground="black" width="0em"></mspace></mpadded></mrow><mtext>   </mtext><mrow><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace height="1.5em" mathbackground="black" width="0em"></mspace></mpadded></mrow></mrow></mstyle></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mo lspace="0em" rspace="0em">⋱</mo></mstyle></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mrow><mi mathvariant="normal">⋮</mi><mpadded height="0em" voffset="0em"><mspace height="1.5em" mathbackground="black" width="0em"></mspace></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle="false" scriptlevel="0"><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>f</mi><mi>m</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>1</mn></msub></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>f</mi><mi>m</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mn>2</mn></msub></mrow></mfrac></mrow></mstyle></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mo lspace="0em" rspace="0em">⋯</mo></mstyle></mtd><mtd><mstyle displaystyle="false" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>f</mi><mn>1</mn></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>n</mi></msub></mrow></mfrac></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{J}_f(X) = \begin{bmatrix}

\frac{\partial{f_1}}{\partial x_1} \frac{\partial{f_1}}{\partial x_2} &amp; \cdots &amp; \frac{\partial{f_1}}{\partial x_n} \\

\frac{\partial{f_2}}{\partial x_1} \frac{\partial{f_2}}{\partial x_2} &amp; \cdots &amp; \frac{\partial{f_1}}{\partial x_n} \\ 

\vdots \space\space\ \vdots &amp; \ddots &amp; \vdots \\

\frac{\partial{f_m}}{\partial x_1} \frac{\partial{f_m}}{\partial x_2} &amp; \cdots &amp; \frac{\partial{f_1}}{\partial x_n}
\end{bmatrix}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathrm">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:6em;vertical-align:-2.75em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg height="6.000em" viewBox="0 0 667 6000" width="0.667em" xmlns="http://www.w3.org/2000/svg"><path d="M403 1759 V84 H666 V0 H319 V1759 v2400 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v2400 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.246em;"><span style="top:-6.0013em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.1076em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.1076em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-4.6239em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.1076em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.1076em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.6788em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span><span class="mspace"> </span><span class="mspace"> </span><span class="mspace"> </span><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.3866em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.1076em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.1076em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.746em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.246em;"><span style="top:-5.8138em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">⋯</span></span></span><span style="top:-4.4364em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">⋯</span></span></span><span style="top:-2.4913em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">⋱</span></span></span><span style="top:-1.1991em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">⋯</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.746em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.246em;"><span style="top:-6.0013em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.1076em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-4.6239em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.1076em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.6788em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.3866em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:-0.1076em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.746em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg height="6.000em" viewBox="0 0 667 6000" width="0.667em" xmlns="http://www.w3.org/2000/svg"><path d="M347 1759 V0 H0 V84 H263 V1759 v2400 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v2400 v1759 h84z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span></span></span></span></span></div></div></div><div></div></div></div></div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="25a0b1a7-76e1-80a7-a838-ca5e8227b240" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>#jax.vjp</span></div></h2><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-800b-a4b3-d99a69988ba8" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">forward mode <span class="notion-enable-hover" data-token-index="1" style="font-weight:600">vector Jacobian product</span>: computes <span class="notion-text-equation-token" contenteditable="false" data-token-index="3" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">J</mi><mi mathvariant="normal">.</mi><mi mathvariant="bold">v</mi></mrow><annotation encoding="application/x-tex">\mathbf{J}.\mathbf{v}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">J</span><span class="mord">.</span><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span></span></span></span><span>﻿</span></span>: directional derivative along the input vector <span class="notion-text-equation-token" contenteditable="false" data-token-index="5" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">v</mi></mrow><annotation encoding="application/x-tex">\mathbf{v}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span></span></span></span><span>﻿</span></span>​</div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80cf-9f18-d4e48e8f7153" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><span class="notion-enable-hover" data-token-index="0" style="font-weight:600">c</span> is a cotangent vector in output space</div><div></div></div></div></div><div class="notion-selectable notion-column_list-block" data-block-id="25a0b1a7-76e1-80ff-b6b4-d34d6c3437d0" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex;"><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(50% - 23px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="25a0b1a7-76e1-801f-a6db-e492ed0c59ab" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-code-block" data-block-id="25a0b1a7-76e1-8044-96e5-f789da9242a3" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div style="display: flex;"><div aria-labelledby=":rj:" contenteditable="false" data-content-editable-void="true" role="figure" style="flex-grow: 1; text-align: start; position: relative; min-width: 0px; width: 100%; border-radius: 10px;"><div style="background: var(--ca-graBacPriTra); border-radius: 10px;"><div style="padding: 24px 22px;"><div class="line-numbers notion-code-block" style="display: flex; padding: 12px 0px; overflow-x: auto;"><div aria-label="Start typing to edit text" autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: start; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; min-height: 1em; color: var(--c-texPri); white-space: pre;' tabindex="0"><span class="" data-token-index="0">y</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> pullback </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> jax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">vjp</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">f</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> x</span><span class="token punctuation" data-token-index="0">)</span><span>
</span></div></div></div></div><div dir="auto" style="padding-inline-end: 105px;"></div></div>​<div></div></div></div></div></div><div style="position: relative; width: 46px; flex-grow: 0; flex-shrink: 0; transition: opacity 200ms ease-out; opacity: 0;"></div><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(50% - 23px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="25a0b1a7-76e1-802d-b379-d423bca15c46" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-equation-block" data-block-id="25a0b1a7-76e1-8030-aca4-e31033bc3daf" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div contenteditable="false" data-content-editable-void="true" style="display: flex; position: relative;"><div data-popup-origin="true" style="display: contents;"><div aria-expanded="false" aria-haspopup="dialog" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; position: relative; width: 100%; border-radius: 10px;" tabindex="0"><div style="display: flex; padding: 4px 8px; width: 100%; flex-direction: column; overflow: auto; color: inherit; fill: inherit;"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace linebreak="newline"></mspace><mrow><mi mathvariant="normal">v</mi><mi mathvariant="normal">j</mi><mi mathvariant="normal">p</mi></mrow><mo stretchy="false">(</mo><mi mathvariant="bold">c</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi mathvariant="bold">c</mi><mi mathvariant="normal">⊤</mi></msup><mi mathvariant="normal">.</mi><msub><mi mathvariant="normal">J</mi><mi>f</mi></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y = f(x), \\ \mathrm{vjp}(\mathbf{c}) = \mathbf{c}^\top . \mathrm{J}_f(X)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mpunct">,</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathrm">vjp</span></span><span class="mopen">(</span><span class="mord mathbf">c</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1852em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathbf">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord">.</span><span class="mord"><span class="mord mathrm">J</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span></span></div></div></div><div></div></div></div></div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="25a0b1a7-76e1-806a-8829-fbec5cb91e57" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>#jax.jacobian</span></div></h2><div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="25a0b1a7-76e1-8073-8bcb-c8b820e10b47" style="width: 100%; max-width: 100%; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h4 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.25em; line-height: 1.3; margin: 0px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>#jax.jacfwd</span></div></h4><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80eb-b627-dded9bee062b" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">compute the full Jacobian matrix in forward mode diff: efficient when <span class="notion-enable-hover" data-token-index="1" style="font-weight:600;color:var(--c-redTexSec);fill:var(--c-redTexSec);isolation:auto">input</span> dim is small</div><div></div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="25a0b1a7-76e1-805a-8a7b-c90747a1d1c6" style="width: 100%; max-width: 100%; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h4 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.25em; line-height: 1.3; margin: 0px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>#jax.jacrev</span></div> </h4><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8088-bd98-f98e45a395b8" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">compute the full Jacobian matrix in forward mode diff: efficient when <span class="notion-enable-hover" data-token-index="1" style="font-weight:600;color:var(--c-redTexSec);fill:var(--c-redTexSec);isolation:auto">output</span> dim is small</div><div></div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="25a0b1a7-76e1-80c1-b022-d84722f1bae9" style="width: 100%; max-width: 100%; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h4 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.25em; line-height: 1.3; margin: 0px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>#jax.jacobian</span></div> </h4><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8048-89d5-f009845facd2" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">a high level wrapper that dynamically chooses <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.jacrev</span></div> or <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="3" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.jacfwd</span></div> depending on input, output shapes</div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8084-99ff-f63a8f73bb10" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div></div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="25a0b1a7-76e1-80ea-88fa-ccf2f46555b9" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>#jax.linearize</span></div></h2><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80f7-be28-e3303e01dcb1" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">evaluate a function <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>f</span></div>at  point / input vector <span class="notion-enable-hover" data-token-index="3" style="font-weight:600">v </span>and return the output and a linear approximate of <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="5" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>f</span></div> </div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80d4-ba74-cbc471d02540" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">used for efficient compute</div><div></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="25a0b1a7-76e1-80a2-9fe9-fa8e63d33915" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div aria-labelledby=":rk:" contenteditable="false" data-content-editable-void="true" role="figure" style="flex-grow: 1; text-align: start; position: relative; min-width: 0px; width: 100%; border-radius: 10px;"><div style="background: var(--ca-graBacPriTra); border-radius: 10px;"><div style="padding: 24px 22px;"><div class="line-numbers notion-code-block" style="display: flex; padding: 12px 0px; overflow-x: auto;"><div aria-label="Start typing to edit text" autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: start; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; min-height: 1em; color: var(--c-texPri); white-space: pre;' tabindex="0"><span class="" data-token-index="0">y</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> f_lin </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> jax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">linearize</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">f</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> x</span><span class="token punctuation" data-token-index="0">)</span><span>
</span></div></div></div></div><div dir="auto" style="padding-inline-end: 105px;"></div></div>​<div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="25a0b1a7-76e1-8076-93ca-fd531e5a77f4" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>#jax.hessian</span></div></h2><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8050-a1e5-f7708b8355ab" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">computes the hessian matrix</div><div></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="25a0b1a7-76e1-80e9-b348-fdd6bdbba25a" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div aria-labelledby=":rl:" contenteditable="false" data-content-editable-void="true" role="figure" style="flex-grow: 1; text-align: start; position: relative; min-width: 0px; width: 100%; border-radius: 10px;"><div style="background: var(--ca-graBacPriTra); border-radius: 10px;"><div style="padding: 24px 22px;"><div class="line-numbers notion-code-block" style="display: flex; padding: 12px 0px; overflow-x: auto;"><div aria-label="Start typing to edit text" autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: start; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; min-height: 1em; color: var(--c-texPri); white-space: pre;' tabindex="0"><span class="token keyword" data-token-index="0">import</span><span class="" data-token-index="0"> jax
</span><span class="token keyword" data-token-index="0">def</span><span class="" data-token-index="0"> </span><span class="token function" data-token-index="0">f</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">x</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">:</span><span class="" data-token-index="0">
  </span><span class="token keyword" data-token-index="0">return</span><span class="" data-token-index="0"> x</span><span class="token punctuation" data-token-index="0">[</span><span class="token number" data-token-index="0">0</span><span class="token punctuation" data-token-index="0">]</span><span class="token operator" data-token-index="0">**</span><span class="token number" data-token-index="0">2</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">+</span><span class="" data-token-index="0"> x</span><span class="token punctuation" data-token-index="0">[</span><span class="token number" data-token-index="0">0</span><span class="token punctuation" data-token-index="0">]</span><span class="token operator" data-token-index="0">*</span><span class="" data-token-index="0">x</span><span class="token punctuation" data-token-index="0">[</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">+</span><span class="" data-token-index="0"> x</span><span class="token punctuation" data-token-index="0">[</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span class="token operator" data-token-index="0">**</span><span class="token number" data-token-index="0">3</span><span class="" data-token-index="0">

H </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> jax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">jit</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">jax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">hessian</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">f</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">x</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
H @ v</span><span>
</span></div></div></div></div><div dir="auto" style="padding-inline-end: 105px;"></div></div>​<div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8019-a1f9-fad75c039363" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">alternatives:</div><div></div></div></div></div><div class="notion-selectable notion-column_list-block" data-block-id="25a0b1a7-76e1-8057-9d30-e077f2349c5c" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex;"><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(50% - 23px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="25a0b1a7-76e1-8078-885b-fbc92742fb02" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80e3-baa5-da276e378894" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">using <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.jacfwd</span></div> and <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="3" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.jacrev</span></div></div><div></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="25a0b1a7-76e1-8025-b987-d76bd92187f4" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div aria-labelledby=":ro:" contenteditable="false" data-content-editable-void="true" role="figure" style="flex-grow: 1; text-align: start; position: relative; min-width: 0px; width: 100%; border-radius: 10px;"><div style="background: var(--ca-graBacPriTra); border-radius: 10px;"><div style="padding: 24px 22px;"><div class="line-numbers notion-code-block" style="display: flex; padding: 12px 0px; overflow-x: auto;"><div aria-label="Start typing to edit text" autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: start; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; min-height: 1em; color: var(--c-texPri); white-space: pre;' tabindex="0"><span class="token keyword" data-token-index="0">from</span><span class="" data-token-index="0"> jax </span><span class="token keyword" data-token-index="0">import</span><span class="" data-token-index="0"> jacfwd</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> jacrev

</span><span class="token keyword" data-token-index="0">def</span><span class="" data-token-index="0"> </span><span class="token function" data-token-index="0">hessian</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">f</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">:</span><span class="" data-token-index="0">
    </span><span class="token keyword" data-token-index="0">return</span><span class="" data-token-index="0"> jax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">jit</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">jacfwd</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">jacrev</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">f</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">

H </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> hessian</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">f</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">x</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
Hv </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> H @ v</span><span>
</span></div></div></div></div><div dir="auto" style="padding-inline-end: 105px;"></div></div>​<div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80fc-8949-c1fedc475f37" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div></div></div></div></div></div></div><div style="position: relative; width: 46px; flex-grow: 0; flex-shrink: 0; transition: opacity 200ms ease-out; opacity: 0;"></div><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(50% - 23px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="25a0b1a7-76e1-8055-af57-c133a40169ba" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80b3-9000-d4042e9698a7" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">using <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.linearize</span></div> and <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="3" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.grad</span></div> </div><div></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="25a0b1a7-76e1-803a-9150-cb2468807975" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div style="display: flex;"><div aria-labelledby=":rp:" contenteditable="false" data-content-editable-void="true" role="figure" style="flex-grow: 1; text-align: start; position: relative; min-width: 0px; width: 100%; border-radius: 10px;"><div style="background: var(--ca-graBacPriTra); border-radius: 10px;"><div style="padding: 24px 22px;"><div class="line-numbers notion-code-block" style="display: flex; padding: 12px 0px; overflow-x: auto;"><div aria-label="Start typing to edit text" autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: start; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; min-height: 1em; color: var(--c-texPri); white-space: pre;' tabindex="0"><span class="token keyword" data-token-index="0">import</span><span class="" data-token-index="0"> jax

y</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> f_lin </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> jax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">linearize</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">
	jax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">grad</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">f</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> x
</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
v </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> jnp</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">array</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">[</span><span class="token number" data-token-index="0">1.</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> </span><span class="token number" data-token-index="0">1.</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
Hv </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> jax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">jit</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">f_lin</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">v</span><span class="token punctuation" data-token-index="0">)</span><span>
</span></div></div></div></div><div dir="auto" style="padding-inline-end: 105px;"></div></div>​<div></div></div></div></div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="25a0b1a7-76e1-805b-8574-d5eddea0bea4" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;">vmap &amp; pmap</h2><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-808f-a96b-e9103868a93c" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>vmap</span></div> traces inputs arguments just like <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="2" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.jit</span></div> and adds a batch dimension at axis 0 by default, batch dimension position can be configured for inputs and outputs with <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="4" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>in_axes</span></div> &amp; <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="6" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>out_axes</span></div> </div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-8072-9b64-e2c7fcc78085" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">(if set to None, the corresponding argument won’t be vectorized)</div><div></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="25b0b1a7-76e1-8003-abf5-eee36dbcae75" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div aria-labelledby=":rq:" contenteditable="false" data-content-editable-void="true" role="figure" style="flex-grow: 1; text-align: start; position: relative; min-width: 0px; width: 100%; border-radius: 10px;"><div style="background: var(--ca-graBacPriTra); border-radius: 10px;"><div style="padding: 24px 22px;"><div class="line-numbers notion-code-block" style="display: flex; padding: 12px 0px; overflow-x: auto;"><div aria-label="Start typing to edit text" autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: start; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; min-height: 1em; color: var(--c-texPri); white-space: pre;' tabindex="0"><span class="" data-token-index="0">xs </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> jnp</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">stack</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">x</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> x</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">    </span><span class="token comment" data-token-index="0"># (b, n)</span><span class="" data-token-index="0">
wst </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> jnp</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">stack</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">w</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> w</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">T </span><span class="token comment" data-token-index="0"># (n, b)</span><span class="" data-token-index="0">

jax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">vmap</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">convolve1d</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> in_axis</span><span class="token operator" data-token-index="0">=</span><span class="token punctuation" data-token-index="0">[</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> </span><span class="token boolean" data-token-index="0">None</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> out_axis</span><span class="token operator" data-token-index="0">=</span><span class="token number" data-token-index="0">0</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">xst</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> w</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0"> </span><span class="token comment" data-token-index="0"># (b, n)</span><span>
</span></div></div></div></div><div dir="auto" style="padding-inline-end: 105px;"></div></div>​<div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-8067-b977-d6996ffda4af" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">note: <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>in_axes</span></div> &amp; <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="3" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>out_axes</span></div> in <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="5" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>vmap</span></div> … can be <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="7" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>Pytrees</span></div> with the same structure on the corresponding input &amp; output <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="9" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>Pytrees</span></div></div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-8022-822f-ed7056aa16be" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">and a whole branch of a <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>Pytree</span></div> can be set to the same value (no need to specify the whole structure + the same value at each leaf)</div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-80c4-9610-e9f1eadce0a0" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-806c-b3a5-fe8f7c04211b" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">vectorized map</div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8087-b1e2-fe80a6069640" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">parallel map: SPMD</div><div></div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="25a0b1a7-76e1-8010-93b7-cde07ef42231" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;">Jaxpr</h2><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8043-b6cb-eebb5ab1af8b" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>Jaxpr</span></div> : Jax exPRession (torch IR eq)</div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80ea-8983-e4ef09af4869" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">is a representation of a sequence of primitive operations encoding the shape &amp; type of each operation, args, inputs, outputs</div><div></div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="25a0b1a7-76e1-808b-96d9-ef4397c662ae" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;">PyTree</h2><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8000-b600-ed7728322ade" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><span class="notion-enable-hover" data-token-index="0" style="font-style:italic">*a functional freak solution for tossing states around*</span></div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80e8-9be3-dce9b88e5ed7" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">a tree is a collection of tensors such as a model’s params, an optimizer state, …</div><div></div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="25b0b1a7-76e1-80d4-b9f2-d0f882d28f78" style="width: 100%; max-width: 100%; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h4 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.25em; line-height: 1.3; margin: 0px;">Key paths</h4><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-80d9-a7c2-d126c1537ed6" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">a leaf’s key path is a list of keys of length = depth of leaf</div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-8029-b448-fd5520b755db" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-801b-9aa1-e458d2db1803" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.tree_util.keystr()</span></div> provide a reader-friendly path key <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="2" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>repr</span></div> with a preset of keys for predefined nodes and using <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="4" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>__str__</span></div> in custom ones</div><div></div></div></div></div><div class="notion-selectable notion-table-block" data-block-id="25b0b1a7-76e1-80ff-9181-e4e7369a130d" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div><div contenteditable="false" data-content-editable-void="true" style="color: inherit; fill: inherit; position: relative; display: flex;"><div class="notion-selectable notion-table-block" data-block-id="25b0b1a7-76e1-80ff-9181-e4e7369a130d" style="width: 100%; position: relative; align-self: center; max-width: 100%;"><div class="notion-scroller horizontal" style="z-index: 1; flex-grow: 1; padding-inline-start: 20px; margin-inline-start: -20px; overflow: auto hidden;"><div class="notion-table-content" style="padding-inline-end: 20px;"><div style="display: flex;"><div style="padding-top: 8px; padding-bottom: 24px; padding-inline-end: 24px;"><div class="notion-selectable notion-table-block notion-table-tbody-selectable" data-block-id="25b0b1a7-76e1-80ff-9181-e4e7369a130d" style="position: relative;"><div><table style="isolation: auto;"><tbody style="isolation: auto;"><tr class="notion-table-row" style="isolation: auto;"><td style="color: inherit; fill: inherit; border: 1px solid var(--c-tabDivCol); isolation: auto; position: relative; vertical-align: top; text-align: start; min-width: 178.667px; max-width: 178.667px; min-height: 32px;"><div class="notion-table-cell" style="isolation: auto;"><div aria-label="Start typing to edit text" class="notion-table-cell-text" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding: 7px 9px; background-color: transparent; font-size: 12px; line-height: 20px;" tabindex="0">function</div></div></td><td style="color: inherit; fill: inherit; border: 1px solid var(--c-tabDivCol); isolation: auto; position: relative; vertical-align: top; text-align: start; min-width: 293.663px; max-width: 293.663px; min-height: 32px;"><div class="notion-table-cell" style="isolation: auto;"><div aria-label="Start typing to edit text" class="notion-table-cell-text" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding: 7px 9px; background-color: transparent; font-size: 12px; line-height: 20px;" tabindex="0"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.tree.flatten</span></div></div></div></td><td style="color: inherit; fill: inherit; border: 1px solid var(--c-tabDivCol); isolation: auto; position: relative; vertical-align: top; text-align: start; min-width: 319.663px; max-width: 319.663px; min-height: 32px;"><div class="notion-table-cell" style="isolation: auto;"><div aria-label="Start typing to edit text" class="notion-table-cell-text" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding: 7px 9px; background-color: transparent; font-size: 12px; line-height: 20px;" tabindex="0"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.tree.map</span></div></div></div></td></tr><tr class="notion-table-row" style="isolation: auto;"><td style="color: inherit; fill: inherit; border: 1px solid var(--c-tabDivCol); isolation: auto; position: relative; vertical-align: top; text-align: start; min-width: 178.667px; max-width: 178.667px; min-height: 32px;"><div class="notion-table-cell" style="isolation: auto;"><div aria-label="Start typing to edit text" class="notion-table-cell-text" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding: 7px 9px; background-color: transparent; font-size: 12px; line-height: 20px;" tabindex="0">path key function</div></div></td><td style="color: inherit; fill: inherit; border: 1px solid var(--c-tabDivCol); isolation: auto; position: relative; vertical-align: top; text-align: start; min-width: 293.663px; max-width: 293.663px; min-height: 32px;"><div class="notion-table-cell" style="isolation: auto;"><div aria-label="Start typing to edit text" class="notion-table-cell-text" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding: 7px 9px; background-color: transparent; font-size: 12px; line-height: 20px;" tabindex="0"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.tree_util.tree_flatten_with_path</span></div></div></div></td><td style="color: inherit; fill: inherit; border: 1px solid var(--c-tabDivCol); isolation: auto; position: relative; vertical-align: top; text-align: start; min-width: 319.663px; max-width: 319.663px; min-height: 32px;"><div class="notion-table-cell" style="isolation: auto;"><div aria-label="Start typing to edit text" class="notion-table-cell-text" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding: 7px 9px; background-color: transparent; font-size: 12px; line-height: 20px;" tabindex="0"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.tree_util.tree_map_with_path</span></div></div></div></td></tr><tr class="notion-table-row" style="isolation: auto;"><td style="color: inherit; fill: inherit; border: 1px solid var(--c-tabDivCol); isolation: auto; position: relative; vertical-align: top; text-align: start; min-width: 178.667px; max-width: 178.667px; min-height: 32px;"><div class="notion-table-cell" style="isolation: auto;"><div aria-label="Start typing to edit text" class="notion-table-cell-text" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding: 7px 9px; background-color: transparent; font-size: 12px; line-height: 20px;" tabindex="0">difference</div></div></td><td style="color: inherit; fill: inherit; border: 1px solid var(--c-tabDivCol); isolation: auto; position: relative; vertical-align: top; text-align: start; min-width: 293.663px; max-width: 293.663px; min-height: 32px;"><div class="notion-table-cell" style="isolation: auto;"><div aria-label="Start typing to edit text" class="notion-table-cell-text" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding: 7px 9px; background-color: transparent; font-size: 12px; line-height: 20px;" tabindex="0">return path key for each leaf</div></div></td><td style="color: inherit; fill: inherit; border: 1px solid var(--c-tabDivCol); isolation: auto; position: relative; vertical-align: top; text-align: start; min-width: 319.663px; max-width: 319.663px; min-height: 32px;"><div class="notion-table-cell" style="isolation: auto;"><div aria-label="Start typing to edit text" class="notion-table-cell-text" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding: 7px 9px; background-color: transparent; font-size: 12px; line-height: 20px;" tabindex="0">expect path key with each as input with each leaf</div></div></td></tr></tbody></table></div></div></div></div></div></div></div><div></div></div></div></div><div class="notion-selectable notion-sub_header-block" data-block-id="25a0b1a7-76e1-80ac-9c05-fc593d717992" style="width: 100%; max-width: 100%; margin-top: 1.4em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h3 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 2" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.5em; line-height: 1.3; margin: 0px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>#jax.tree.structure &amp; #jax.tree.leaves</span></div>  </h3><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8080-9192-f2cb6a4ce375" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">skims a collection and extract it’s structure / leaves</div><div></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="25a0b1a7-76e1-806d-adb7-ed1f8c6460a9" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div aria-labelledby=":rr:" contenteditable="false" data-content-editable-void="true" role="figure" style="flex-grow: 1; text-align: start; position: relative; min-width: 0px; width: 100%; border-radius: 10px;"><div style="background: var(--ca-graBacPriTra); border-radius: 10px;"><div style="padding: 24px 22px;"><div class="line-numbers notion-code-block" style="display: flex; padding: 12px 0px; overflow-x: auto;"><div aria-label="Start typing to edit text" autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: start; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; min-height: 1em; color: var(--c-texPri); white-space: pre;' tabindex="0"><span class="" data-token-index="0">PyTreeDef</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">[</span><span class="token operator" data-token-index="0">*</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">*</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">“key”</span><span class="token punctuation" data-token-index="0">:</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">*</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> “keys”</span><span class="token punctuation" data-token-index="0">:</span><span class="" data-token-index="0"> </span><span class="token punctuation" data-token-index="0">{</span><span class="" data-token-index="0">”key1”</span><span class="token punctuation" data-token-index="0">:</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">*</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> “key2”</span><span class="token punctuation" data-token-index="0">:</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">*</span><span class="token punctuation" data-token-index="0">}</span><span class="token punctuation" data-token-index="0">}</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">num1</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> num2</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> Array</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">…</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> dtype</span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0">…</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> Array</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">…</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> dtype</span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0">…</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> Array</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">[</span><span class="" data-token-index="0">…</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> dtype</span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0">…</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">]</span><span>
</span></div></div></div></div><div dir="auto" style="padding-inline-end: 105px;"></div></div>​<div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25b0b1a7-76e1-80ea-8913-c5533cda67c9" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.tree.map(func, tree(s))</span></div> </div><div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-807d-b090-d6a04a32b5c1" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">applies a function to all nodes (example: rescale)</div><div></div></div></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25b0b1a7-76e1-801a-a3a8-ff04c4555e74" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.util_tree.register_pytree_node(Container_class, flatten_fn</span></div>,<div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="2" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>unflatten_fn)</span></div></div><div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-80cc-8cc7-cddd34c45218" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">register a custom container to use in a <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>PyTree</span></div> </div><div></div></div></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25b0b1a7-76e1-804b-81cc-ffdea0584d95" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.util_tree.register_dataclass(DataClass, data_fileds=[...], meta_fields=[...])</span></div></div><div></div></div><div class="notion-selectable notion-code-block" data-block-id="25b0b1a7-76e1-8073-90e9-f1121d464abb" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div style="display: flex;"><div aria-labelledby=":rs:" contenteditable="false" data-content-editable-void="true" role="figure" style="flex-grow: 1; text-align: start; position: relative; min-width: 0px; width: 100%; border-radius: 10px;"><div style="background: var(--ca-graBacPriTra); border-radius: 10px;"><div style="padding: 24px 22px;"><div class="line-numbers notion-code-block" style="display: flex; padding: 12px 0px; overflow-x: auto;"><div aria-label="Start typing to edit text" autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: start; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; min-height: 1em; color: var(--c-texPri); white-space: pre;' tabindex="0"><span class="token decorator annotation punctuation" data-token-index="0">@functools</span><span class="token punctuation decorator annotation" data-token-index="0">.</span><span class="token decorator annotation punctuation" data-token-index="0">partial</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">jax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">tree_util</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">register_dataclass</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">
                   data_fields</span><span class="token operator" data-token-index="0">=</span><span class="token punctuation" data-token-index="0">[</span><span class="token punctuation" data-token-index="0">.</span><span class="token punctuation" data-token-index="0">.</span><span class="token punctuation" data-token-index="0">.</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0">
                   meta_fields</span><span class="token operator" data-token-index="0">=</span><span class="token punctuation" data-token-index="0">[</span><span class="token punctuation" data-token-index="0">.</span><span class="token punctuation" data-token-index="0">.</span><span class="token punctuation" data-token-index="0">.</span><span class="token punctuation" data-token-index="0">]</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
</span><span class="token decorator annotation punctuation" data-token-index="0">@dataclass</span><span class="" data-token-index="0">
</span><span class="token keyword" data-token-index="0">class</span><span class="" data-token-index="0"> </span><span class="token class-name" data-token-index="0">MyDataclassContainer</span><span class="token punctuation" data-token-index="0">(</span><span class="token builtin" data-token-index="0">object</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">:</span><span class="" data-token-index="0">
    </span><span class="token punctuation" data-token-index="0">.</span><span class="token punctuation" data-token-index="0">.</span><span class="token punctuation" data-token-index="0">.</span><span>
</span></div></div></div></div><div dir="auto" style="padding-inline-end: 105px;"></div></div>​<div></div></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25b0b1a7-76e1-8038-9ca8-ee6d5aff6a17" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.tree.leaves</span></div> with <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="2" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>is_leaf</span></div> to consider <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="4" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>None</span></div> as leaves</div><div></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25b0b1a7-76e1-80e0-ac2b-f14fb9ecedc9" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">f</div><div></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25b0b1a7-76e1-808e-a481-c53744d6bf38" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">f</div><div></div></div><div class="notion-selectable notion-header-block" data-block-id="25a0b1a7-76e1-807e-bf48-e312a86b1697" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;">#TO-DO: add try_util functions</h2><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-802c-ac08-cf2894a44e40" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div></div></div></div></div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="25a0b1a7-76e1-80b4-9a46-d56551c7f724" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;">LAX</h2><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-801e-afbd-d249a8e9ef81" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><span class="notion-enable-hover" data-token-index="0" style="font-style:italic">*jnp &amp; LAX vs torch.nn.functional &amp; aten*</span></div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8088-8eef-fc14daafcf61" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">lax is similar to jax.numpy, by a raw, lower-level XLA primitives focus mirror of it, requires careful use, enables more efficient &amp; general operations</div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8027-bc80-e2b59ede12d2" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">at core all lax operations are python wrapper of XLA operations, with few to no guards, checks or constraints (optimize at your own risk ye 3abit)</div><div></div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="25b0b1a7-76e1-8058-9441-dad3f6228e00" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;">Debugging</h2><div></div></div></div><div class="notion-selectable notion-sub_header-block" data-block-id="25b0b1a7-76e1-801f-b51b-e3bff51266eb" style="width: 100%; max-width: 100%; margin-top: 1.4em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h3 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 2" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.5em; line-height: 1.3; margin: 0px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>#jax.debug.print(...)</span></div></h3><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-80c0-9f35-dd0bd822b504" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">python’s print will only work during tracing, </div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-804e-bf39-d39d1c5df55f" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">to keep printing / debugging in subsequent runs use <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.debug.print</span></div></div><div></div></div><div style="padding-inline-start: 1.5em; display: flex; flex-direction: column;"><div class="notion-selectable notion-code-block" data-block-id="25b0b1a7-76e1-8087-9079-db6bd07f8e0b" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div style="display: flex;"><div aria-labelledby=":r11:" contenteditable="false" data-content-editable-void="true" role="figure" style="flex-grow: 1; text-align: start; position: relative; min-width: 0px; width: 100%; border-radius: 10px;"><div style="background: var(--ca-graBacPriTra); border-radius: 10px;"><div style="padding: 24px 22px;"><div class="line-numbers notion-code-block" style="display: flex; padding: 12px 0px; overflow-x: auto;"><div aria-label="Start typing to edit text" autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: start; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; min-height: 1em; color: var(--c-texPri); white-space: pre;' tabindex="0"><span class="" data-token-index="0">jax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">debug</span><span class="token punctuation" data-token-index="0">.</span><span class="token keyword" data-token-index="0">print</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"x shape: {shape}"</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> shape</span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0">x</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">shape</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> ordered</span><span class="token operator" data-token-index="0">=</span><span class="token boolean" data-token-index="0">False</span><span class="token punctuation" data-token-index="0">)</span><span>
</span></div></div></div></div><div dir="auto" style="padding-inline-end: 105px;"></div></div>​<div></div></div></div></div></div></div><div class="notion-selectable notion-sub_header-block" data-block-id="25b0b1a7-76e1-80bc-a05a-d0d837e8838d" style="width: 100%; max-width: 100%; margin-top: 1.4em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h3 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 2" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.5em; line-height: 1.3; margin: 0px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>#jax.debug.breakpoint()</span></div> </h3><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-80f3-870e-c280708ade0a" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">opens an interactive window at the specified point</div><div></div></div></div></div><div class="notion-selectable notion-sub_header-block" data-block-id="25b0b1a7-76e1-808f-b158-ca433bf05cca" style="width: 100%; max-width: 100%; margin-top: 1.4em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h3 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 2" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.5em; line-height: 1.3; margin: 0px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>#jax.debug.callback(python_func, inputs)</span></div></h3><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-8083-bbac-ef79a3a22b86" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">it calls a python function from inside a <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax</span></div> transformed function</div><div></div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="25b0b1a7-76e1-8045-a686-d6260bc2e74b" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;">Pseudo-Random Number Generator</h2><div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-80c9-b2f8-fb2249bcbe31" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">in <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>numpy</span></div> the global random state is updated after each generation</div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-80cc-88a8-db329fc0a2c1" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">which wouldn’t be compatible with what’s <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax</span></div> aiming to achieve while being reproducible mainly for being stateful, order depending (<div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="3" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax</span></div> execute vectorized and parallelized operations in no deterministic order)</div><div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-80da-8cc0-f2ce47814995" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">in <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax</span></div> the random generation state / key is explicitly handled</div><div></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="25b0b1a7-76e1-80ac-a1af-d02d061bd0f2" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div aria-labelledby=":r12:" contenteditable="false" data-content-editable-void="true" role="figure" style="flex-grow: 1; text-align: start; position: relative; min-width: 0px; width: 100%; border-radius: 10px;"><div style="background: var(--ca-graBacPriTra); border-radius: 10px;"><div style="padding: 24px 22px;"><div class="line-numbers notion-code-block" style="display: flex; padding: 12px 0px; overflow-x: auto;"><div aria-label="Start typing to edit text" autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: start; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; min-height: 1em; color: var(--c-texPri); white-space: pre;' tabindex="0"><span class="" data-token-index="0">jnp</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">random</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">key</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">seed</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
new_key</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">*</span><span class="" data-token-index="0">n_sub_keys </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> jnp</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">random</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">split</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">key</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> n</span><span class="token punctuation" data-token-index="0">)</span><span>
</span></div></div></div></div><div dir="auto" style="padding-inline-end: 105px;"></div></div>​<div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2780b1a7-76e1-80ad-a24b-d8f12804e9d6" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.random.fold_in</span></div> is used to generate per-device random keys starting from the same root key injected with the device idx</div><div></div></div></div></div></div></div><div style="position: relative; width: 46px; flex-grow: 0; flex-shrink: 0; transition: opacity 200ms ease-out; opacity: 0;"></div><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(50% - 23px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="2590b1a7-76e1-8090-bdb9-f0558de6ab4a" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-text-block" data-block-id="2790b1a7-76e1-806a-9675-e28a24e5aa70" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.config.update('jax_num_cpu_devices', 8)</span></div> until we overcome unemployment</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-sub_header-block" data-block-id="25a0b1a7-76e1-80e9-a639-e1f6b49a4bbd" style="width: 100%; max-width: 100%; margin-top: 1.4em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h3 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 2" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.5em; line-height: 1.3; margin: 0px;">My Gotchas &amp; Notes</h3><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25a0b1a7-76e1-80f9-bece-ecefd770bb0a" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jnp</span></div> functions are strict with type rules (stricter than <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="2" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>numpy</span></div>), most operations expect floating point arrays</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25a0b1a7-76e1-80f9-a8c4-fc79904c4eab" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">[func].block_until_ready(): account for asynchronous dispatch</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25a0b1a7-76e1-8021-9c94-fed812190e0d" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jnp.reshape</span></div> expect a static shape</div><div style="position: relative; inset-inline-start: 0px;"></div></div><div class="notion-selectable notion-code-block" data-block-id="25a0b1a7-76e1-806e-b55a-d2c5075a1c24" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div style="display: flex;"><div aria-labelledby=":r4:" contenteditable="false" data-content-editable-void="true" role="figure" style="flex-grow: 1; text-align: start; position: relative; min-width: 0px; width: 100%; border-radius: 10px;"><div style="background: var(--ca-graBacPriTra); border-radius: 10px;"><div style="padding: 24px 22px;"><div class="line-numbers notion-code-block" style="display: flex; padding: 12px 0px; overflow-x: auto;"><div aria-label="Start typing to edit text" autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: start; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; min-height: 1em; color: var(--c-texPri); white-space: pre;' tabindex="0"><span class="token comment" data-token-index="0"># wrong traced shaped: known at run time by XLA</span><span class="" data-token-index="0">
jnp</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">reshape</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">x</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> jnp</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">array</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">x</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">shape</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">prod</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
</span><span class="token comment" data-token-index="0"># correct static shape: known at compile time</span><span class="" data-token-index="0">
jnp</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">reshape</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">x</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> np</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">prod</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">x</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">shape</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span>
</span></div></div></div></div><div dir="auto" style="padding-inline-end: 105px;"></div></div>​<div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25f0b1a7-76e1-80f8-a2ac-dfb7135e2b43" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.core.freeze</span></div> &amp; <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="2" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.core.unfreeze</span></div> : freeze &amp; unfreeze python containers to use in a <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="4" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>pytree</span></div> </div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="25a0b1a7-76e1-8003-8f92-ea2d9207ee9f" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;">Advanced &amp; Experimental</h2><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25a0b1a7-76e1-80e9-851d-f6b92e672b4a" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">dynamic shapes in <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jit</span></div> trace</div><div style="position: relative; inset-inline-start: 0px;"></div></div><div class="notion-selectable notion-code-block" data-block-id="25a0b1a7-76e1-8066-922f-f105ad79c33a" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div style="display: flex;"><div aria-labelledby=":r5:" contenteditable="false" data-content-editable-void="true" role="figure" style="flex-grow: 1; text-align: start; position: relative; min-width: 0px; width: 100%; border-radius: 10px;"><div style="background: var(--ca-graBacPriTra); border-radius: 10px;"><div style="padding: 24px 22px;"><div class="line-numbers notion-code-block" style="display: flex; padding: 12px 0px; overflow-x: auto;"><div aria-label="Start typing to edit text" autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: start; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; min-height: 1em; color: var(--c-texPri); white-space: pre;' tabindex="0"><span class="" data-token-index="0">jax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">config</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">update</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"jax_dynamic_shapes"</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> </span><span class="token boolean" data-token-index="0">True</span><span class="token punctuation" data-token-index="0">)</span><span>
</span></div></div></div></div><div dir="auto" style="padding-inline-end: 105px;"></div></div>​<div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25a0b1a7-76e1-804d-9cde-dcd0adb1ed44" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">disable implicit type promotion</div><div style="position: relative; inset-inline-start: 0px;"></div></div><div class="notion-selectable notion-code-block" data-block-id="25a0b1a7-76e1-8025-9b11-f9a942810de8" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div style="display: flex;"><div aria-labelledby=":r6:" contenteditable="false" data-content-editable-void="true" role="figure" style="flex-grow: 1; text-align: start; position: relative; min-width: 0px; width: 100%; border-radius: 10px;"><div style="background: var(--ca-graBacPriTra); border-radius: 10px;"><div style="padding: 24px 22px;"><div class="line-numbers notion-code-block" style="display: flex; padding: 12px 0px; overflow-x: auto;"><div aria-label="Start typing to edit text" autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: start; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; min-height: 1em; color: var(--c-texPri); white-space: pre;' tabindex="0"><span class="token comment" data-token-index="0"># still allows python scalars</span><span class="" data-token-index="0">
</span><span class="token comment" data-token-index="0"># standard is the default mode</span><span class="" data-token-index="0">
jax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">config</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">update</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">'jax_numpy_dtype_promotion'</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> </span><span class="token string" data-token-index="0">'strict'</span><span class="token punctuation" data-token-index="0">)</span><span>
</span></div></div></div></div><div dir="auto" style="padding-inline-end: 105px;"></div></div>​<div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80ad-bf09-fe37b928188d" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8012-8fad-c55aa7772c64" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="25a0b1a7-76e1-804f-b196-e39c75dccbe4" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;">LAX utils</h2><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25c0b1a7-76e1-80d9-8e65-d75258fa12d0" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>logical_and</span></div>, <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="2" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>logical_or</span></div>, and <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="4" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>logical_not</span></div> (bit wise ops can be used under <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="6" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jit</span></div> (no short circuit))</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25b0b1a7-76e1-8022-a648-f688d453193f" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>lax.cond(bool_check, true_fn, false_fn, fn_input)</span></div></div><div style="position: relative; inset-inline-start: 0px;"></div></div><div class="notion-selectable notion-text-block" data-block-id="25b0b1a7-76e1-8045-98f2-c8fefd00664c" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">both <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>true_fn</span></div> and <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="3" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>false_fn</span></div> should produce the same type and shape to have the same output trace from the condition block</div><div style="position: relative; inset-inline-start: 0px;"></div></div><div style="padding-inline-start: 1.5em; display: flex; flex-direction: column;"><div class="notion-selectable notion-text-block" data-block-id="25c0b1a7-76e1-80e4-a740-e36a375f80aa" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><span class="notion-enable-hover" data-token-index="0" style="font-weight:600">example:</span></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="25b0b1a7-76e1-8064-8686-ed3283e549e4" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div style="display: flex;"><div aria-labelledby=":r7:" contenteditable="false" data-content-editable-void="true" role="figure" style="flex-grow: 1; text-align: start; position: relative; min-width: 0px; width: 100%; border-radius: 10px;"><div style="background: var(--ca-graBacPriTra); border-radius: 10px;"><div style="padding: 24px 22px;"><div class="line-numbers notion-code-block" style="display: flex; padding: 12px 0px; overflow-x: auto;"><div aria-label="Start typing to edit text" autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: start; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; min-height: 1em; color: var(--c-texPri); white-space: pre;' tabindex="0"><span class="token keyword" data-token-index="0">def</span><span class="" data-token-index="0"> </span><span class="token function" data-token-index="0">breakpoint_if_nonfinite</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">x</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">:</span><span class="" data-token-index="0">
  is_finite </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> jnp</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">isfinite</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">x</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">.</span><span class="token builtin" data-token-index="0">all</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
  </span><span class="token keyword" data-token-index="0">def</span><span class="" data-token-index="0"> </span><span class="token function" data-token-index="0">true_fn</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">x</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">:</span><span class="" data-token-index="0">
    </span><span class="token keyword" data-token-index="0">pass</span><span class="" data-token-index="0">
  </span><span class="token keyword" data-token-index="0">def</span><span class="" data-token-index="0"> </span><span class="token function" data-token-index="0">false_fn</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">x</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">:</span><span class="" data-token-index="0">
    jax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">debug</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">breakpoint</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
  jax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">lax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">cond</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">is_finite</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> true_fn</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> false_fn</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> x</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
  
</span><span class="token decorator annotation punctuation" data-token-index="0">@jax</span><span class="token punctuation decorator annotation" data-token-index="0">.</span><span class="token decorator annotation punctuation" data-token-index="0">jit</span><span class="" data-token-index="0">
</span><span class="token keyword" data-token-index="0">def</span><span class="" data-token-index="0"> </span><span class="token function" data-token-index="0">f</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">x</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> y</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">:</span><span class="" data-token-index="0">
	</span><span class="token punctuation" data-token-index="0">.</span><span class="token punctuation" data-token-index="0">.</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">
  breakpoint_if_nonfinite</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">z</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0">
	</span><span class="token punctuation" data-token-index="0">.</span><span class="token punctuation" data-token-index="0">.</span><span class="token punctuation" data-token-index="0">.</span><span>
</span></div></div></div></div><div dir="auto" style="padding-inline-end: 105px;"></div></div>​<div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25b0b1a7-76e1-80ba-8d82-f7efa008523f" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>lax.fori_loop</span></div></div><div style="position: relative; inset-inline-start: 0px;"></div></div><div class="notion-selectable notion-code-block" data-block-id="25b0b1a7-76e1-801e-96ca-f6c35a1f5a19" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div style="display: flex;"><div aria-labelledby=":r8:" contenteditable="false" data-content-editable-void="true" role="figure" style="flex-grow: 1; text-align: start; position: relative; min-width: 0px; width: 100%; border-radius: 10px;"><div style="background: var(--ca-graBacPriTra); border-radius: 10px;"><div style="padding: 24px 22px;"><div class="line-numbers notion-code-block" style="display: flex; padding: 12px 0px; overflow-x: auto;"><div aria-label="Start typing to edit text" autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: start; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; min-height: 1em; color: var(--c-texPri); white-space: pre;' tabindex="0"><span class="" data-token-index="0">lax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">fori_loop</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">i_start</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> i_finish</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> func</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> init_carry</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">-</span><span class="token operator" data-token-index="0">&gt;</span><span class="" data-token-index="0"> final_carry
func</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">i</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> pre_carry</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">-</span><span class="token operator" data-token-index="0">&gt;</span><span class="" data-token-index="0"> new_carry</span><span>
</span></div></div></div></div><div dir="auto" style="padding-inline-end: 105px;"></div></div>​<div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25b0b1a7-76e1-8076-b428-f450806f78cc" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>lax.while_loop</span></div> </div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25a0b1a7-76e1-8063-a846-ecff77fc4385" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>lax.scan</span></div></div><div style="position: relative; inset-inline-start: 0px;"></div></div><div class="notion-selectable notion-code-block" data-block-id="25b0b1a7-76e1-8094-a639-c6175347d291" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div style="display: flex;"><div aria-labelledby=":r9:" contenteditable="false" data-content-editable-void="true" role="figure" style="flex-grow: 1; text-align: start; position: relative; min-width: 0px; width: 100%; border-radius: 10px;"><div style="background: var(--ca-graBacPriTra); border-radius: 10px;"><div style="padding: 24px 22px;"><div class="line-numbers notion-code-block" style="display: flex; padding: 12px 0px; overflow-x: auto;"><div aria-label="Start typing to edit text" autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: start; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; min-height: 1em; color: var(--c-texPri); white-space: pre;' tabindex="0"><span class="" data-token-index="0">lax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">scan</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">func</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> init_carry</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> xs_seq</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">-</span><span class="token operator" data-token-index="0">&gt;</span><span class="" data-token-index="0"> final_carry</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> ys_seq
func</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">pre_carry</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> x</span><span class="token punctuation" data-token-index="0">)</span><span class="" data-token-index="0"> </span><span class="token operator" data-token-index="0">-</span><span class="token operator" data-token-index="0">&gt;</span><span class="" data-token-index="0"> new_carry</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> y</span><span>
</span></div></div></div></div><div dir="auto" style="padding-inline-end: 105px;"></div></div>​<div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25b0b1a7-76e1-8089-a7f2-e4c5b8db5e57" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>lax.map(f, xs)</span></div>
a sequential map run</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25b0b1a7-76e1-80c7-a605-cff76b3ab365" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-token notion-focusable-token notion-enable-hover" data-token-index="0" href="http://lax.select/" rel="noopener noreferrer" style='cursor:pointer;color:#EB5757;word-wrap:break-word;font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em;text-decoration:inherit' tabindex="0"><span class="link-annotation-25b0b1a7-76e1-80c7-a605-cff76b3ab365--2035456199" style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--ca-opaLinDecCol);text-underline-offset:10%;opacity:0.7">lax.select</span></a> : <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="2" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jnp.wher</span></div> ’s core</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25b0b1a7-76e1-80f9-b621-d3fa6e9833f0" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>lax.switch</span></div> : <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="2" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jnp.piecewise</span></div> ’s core</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-sub_header-block" data-block-id="25d0b1a7-76e1-8018-8d78-e75a30f055b7" style="width: 100%; max-width: 100%; margin-top: 1.4em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h3 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 2" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.5em; line-height: 1.3; margin: 0px;">Collective operations</h3><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-8008-a3bd-c8e667e4c332" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">across shards op + replicate</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25d0b1a7-76e1-809c-9a3f-e611a6951d87" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.lax.psum</span></div></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="2670b1a7-76e1-80c7-be37-ca9e1ec05380" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;">Distributed Gotchas</h2><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="2670b1a7-76e1-80f0-b920-d8d337f43cd8" style="width: 100%; max-width: 100%; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h4 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.25em; line-height: 1.3; margin: 0px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.device_put</span></div> vs <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="2" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>out_sharding</span></div></h4><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2670b1a7-76e1-8022-8f69-d30a3e54d189" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.device_put</span></div> moves an array from host to device according to a given sharding</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2670b1a7-76e1-8060-973e-da3b1bc9d71c" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>out_sharding</span></div> kwarg is used to indicate where / how to shard the result of an operation lowered in xla </div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-sub_header-block" data-block-id="2670b1a7-76e1-80e5-8395-e44c998ef872" style="width: 100%; max-width: 100%; margin-top: 1.4em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h3 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 2" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.5em; line-height: 1.3; margin: 0px;">Asynchronous Dispatch</h3><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2670b1a7-76e1-8003-915d-ec7076bc43a1" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">xla computations are delegated to device(s) asynchronously, only shape, dtype, sharding are retrieved instantly so that the Python code can “run ahead of time”</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8050-96ef-c8682063a56f" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-809a-b3c6-c628e2589de8" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">in a training loop (fetch batch, compute) both calls overlap achieving a pseudo parallel run of both, introducing a blocking operation will ruin the orchestration</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2680b1a7-76e1-80fd-b3a6-e3d64899c174" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="2680b1a7-76e1-80bc-b308-d0ac9184f855" style="width: 100%; max-width: 100%; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h4 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.25em; line-height: 1.3; margin: 0px;">host bubble</h4><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2680b1a7-76e1-8072-933d-f65da700de40" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">logging metrics for example (fetch batch, compute, log) would force block the fetching op until the compute operation is completed introducing a bottleneck, to mitigate that we can log the previous metrics</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="2680b1a7-76e1-800d-b80a-dfae25508d34" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div aria-labelledby=":ra:" contenteditable="false" data-content-editable-void="true" role="figure" style="flex-grow: 1; text-align: start; position: relative; min-width: 0px; width: 100%; border-radius: 10px;"><div style="background: var(--ca-graBacPriTra); border-radius: 10px;"><div style="padding: 24px 22px;"><div class="line-numbers notion-code-block" style="display: flex; padding: 12px 0px; overflow-x: auto;"><div aria-label="Start typing to edit text" autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: start; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; min-height: 1em; color: var(--c-texPri); white-space: pre;' tabindex="0"><span class="token keyword" data-token-index="0">class</span><span class="" data-token-index="0"> </span><span class="token class-name" data-token-index="0">RecordWriter</span><span class="token punctuation" data-token-index="0">:</span><span class="" data-token-index="0">
  prev_metrics </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> </span><span class="token boolean" data-token-index="0">None</span><span class="" data-token-index="0">

  </span><span class="token keyword" data-token-index="0">def</span><span class="" data-token-index="0"> </span><span class="token function" data-token-index="0">__call__</span><span class="token punctuation" data-token-index="0">(</span><span class="" data-token-index="0">self</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> cur_metrics</span><span class="token punctuation" data-token-index="0">:</span><span class="" data-token-index="0"> </span><span class="token builtin" data-token-index="0">dict</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">:</span><span class="" data-token-index="0">
    self</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">prev_metrics</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> log_metrics </span><span class="token operator" data-token-index="0">=</span><span class="" data-token-index="0"> cur_metrics</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> self</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">prev_metrics
    </span><span class="token keyword" data-token-index="0">if</span><span class="" data-token-index="0"> log_metrics </span><span class="token keyword" data-token-index="0">is</span><span class="" data-token-index="0"> </span><span class="token boolean" data-token-index="0">None</span><span class="token punctuation" data-token-index="0">:</span><span class="" data-token-index="0">
      </span><span class="token keyword" data-token-index="0">return</span><span class="" data-token-index="0">
    </span><span class="token keyword" data-token-index="0">print</span><span class="token punctuation" data-token-index="0">(</span><span class="token operator" data-token-index="0">*</span><span class="" data-token-index="0">it</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">starmap</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"{}: {}"</span><span class="token punctuation" data-token-index="0">.</span><span class="token builtin" data-token-index="0">format</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> log_metrics</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">items</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span class="" data-token-index="0"> sep</span><span class="token operator" data-token-index="0">=</span><span class="token string" data-token-index="0">"\t"</span><span class="token punctuation" data-token-index="0">)</span><span>
</span></div></div></div></div><div dir="auto" style="padding-inline-end: 105px;"></div></div>​<div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8073-a823-e8e2c69d6708" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-callout-block" data-block-id="2680b1a7-76e1-8093-a76c-f97ae61e409a" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 4px;"><div role="note" style="display: flex;"><div style="display: flex; width: 100%; border-radius: 10px; border: 1px solid transparent; background: var(--c-graBacSec); padding-inline: 20px; padding-top: 12px; padding-bottom: 12px;"><div style="display: flex; flex-direction: column; min-width: 0px; width: 100%; min-height: 32px;"><div class="notion-selectable notion-bulleted_list-block" data-block-id="2680b1a7-76e1-8072-bd80-dd541ced79fc" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">loop</div><div style="position: relative; inset-inline-start: 20px;"></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="2680b1a7-76e1-8094-9901-fb5e64295ea9" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "◦";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">fetch batch<span class="notion-enable-hover" data-token-index="1" style="color:var(--c-bluTexSec);fill:var(--c-bluTexSec);isolation:auto"> █</span></div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="2680b1a7-76e1-8092-9cde-ff5ba6db75f8" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "◦";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">compute     <span class="notion-enable-hover" data-token-index="1" style="color:var(--c-redTexSec);fill:var(--c-redTexSec);isolation:auto">█</span>, enqueue on accelerator: <span class="notion-enable-hover" data-token-index="3" style="color:var(--c-redTexSec);fill:var(--c-redTexSec);isolation:auto">|</span></div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="2680b1a7-76e1-800f-b375-f7b2fa2d51a1" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "◦";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">log         <span class="notion-enable-hover" data-token-index="1" style="color:var(--c-purTexSec);fill:var(--c-purTexSec);isolation:auto">█</span></div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2680b1a7-76e1-8088-ace0-d9a0e1d7dc25" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2680b1a7-76e1-800c-8e4b-d8b10bbcbb61" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">=============================== host ===========================</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2680b1a7-76e1-80db-b5d9-d4cfc9813971" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">[<span class="notion-enable-hover" data-token-index="1" style="color:var(--c-bluTexSec);fill:var(--c-bluTexSec);isolation:auto">█:0</span>]<span class="notion-enable-hover" data-token-index="3" style="color:var(--c-redTexSec);fill:var(--c-redTexSec);isolation:auto">|</span><span class="notion-enable-hover" data-token-index="4" style="color:var(--c-texPri);isolation:auto">[</span><span class="notion-enable-hover" data-token-index="5" style="color:var(--c-purTexSec);fill:var(--c-purTexSec);isolation:auto">█:_</span><span class="notion-enable-hover" data-token-index="6" style="color:var(--c-texPri);isolation:auto">]</span>[<span class="notion-enable-hover" data-token-index="8" style="color:var(--c-bluTexSec);fill:var(--c-bluTexSec);isolation:auto">█:1</span>]<span class="notion-enable-hover" data-token-index="10" style="color:var(--c-redTexSec);fill:var(--c-redTexSec);isolation:auto">|</span><span class="notion-enable-hover" data-token-index="11" style="color:var(--c-texPri);isolation:auto">[</span><span class="notion-enable-hover" data-token-index="12" style="color:var(--c-purTexSec);fill:var(--c-purTexSec);isolation:auto">█:0</span><span class="notion-enable-hover" data-token-index="13" style="color:var(--c-texPri);isolation:auto">]</span>[<span class="notion-enable-hover" data-token-index="15" style="color:var(--c-bluTexSec);fill:var(--c-bluTexSec);isolation:auto">█:2</span>]<span class="notion-enable-hover" data-token-index="17" style="color:var(--c-redTexSec);fill:var(--c-redTexSec);isolation:auto">|</span><span class="notion-enable-hover" data-token-index="18" style="color:var(--c-texPri);isolation:auto">[</span><span class="notion-enable-hover" data-token-index="19" style="color:var(--c-purTexSec);fill:var(--c-purTexSec);isolation:auto">█:1</span><span class="notion-enable-hover" data-token-index="20" style="color:var(--c-texPri);isolation:auto">]…</span></div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2680b1a7-76e1-80de-bb19-c8cc91e7db1c" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">================|==========|== device ==========================</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2680b1a7-76e1-80d9-a337-d1cd9fe81e51" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">_____<span class="notion-enable-hover" data-token-index="1" style="color:var(--c-redTexSec);fill:var(--c-redTexSec);isolation:auto">|</span><span class="notion-enable-hover" data-token-index="2" style="color:var(--c-texPri);isolation:auto">__________[</span><span class="notion-enable-hover" data-token-index="3" style="color:var(--c-redTexSec);fill:var(--c-redTexSec);isolation:auto">████0████</span><span class="notion-enable-hover" data-token-index="4" style="color:var(--c-texPri);isolation:auto">]|[</span><span class="notion-enable-hover" data-token-index="5" style="color:var(--c-redTexSec);fill:var(--c-redTexSec);isolation:auto">████1████</span><span class="notion-enable-hover" data-token-index="6" style="color:var(--c-texPri);isolation:auto">]…</span></div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2680b1a7-76e1-801f-9a30-c12750b22624" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">================================================================

</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2680b1a7-76e1-80d9-8bc3-ce35776d5864" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"># first data fetch, compute0 enqueued, log -1 (N/A),</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2680b1a7-76e1-8066-b8b4-fa0b3458830d" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"># data fetch for next compute, log previous (compute0 res), compute1</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2680b1a7-76e1-80d0-a732-f65bd29ae483" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"># …</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div></div></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2680b1a7-76e1-80d5-95b8-d59d9e7a2477" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="2680b1a7-76e1-801d-ae2c-c0ad96998e89" style="width: 100%; max-width: 100%; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h4 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.25em; line-height: 1.3; margin: 0px;">device bubble</h4><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2680b1a7-76e1-8012-8880-e566a70a680c" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">printing computations outside of the main, jit-compiled “compute” call would force host-device synchronization</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2680b1a7-76e1-80b8-b5d3-f5826fd6a63c" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">⇒ perform additional computations (learning rate update, metrics / logs computes) using <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>numpy</span></div> or on host in <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="3" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax</span></div> to avoid the host-device roundtrip / sync</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="2680b1a7-76e1-80a5-8fff-c611ad298bdf" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div aria-labelledby=":rf:" contenteditable="false" data-content-editable-void="true" role="figure" style="flex-grow: 1; text-align: start; position: relative; min-width: 0px; width: 100%; border-radius: 10px;"><div style="background: var(--ca-graBacPriTra); border-radius: 10px;"><div style="padding: 24px 22px;"><div class="line-numbers notion-code-block" style="display: flex; padding: 12px 0px; overflow-x: auto;"><div aria-label="Start typing to edit text" autocapitalize="off" autocorrect="off" contenteditable="false" data-content-editable-leaf="true" placeholder=" " role="textbox" spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: start; font-family: SFMono-Regular, Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; font-size: 85%; tab-size: 2; min-height: 1em; color: var(--c-texPri); white-space: pre;' tabindex="0"><span class="token keyword" data-token-index="0">with</span><span class="" data-token-index="0"> jax</span><span class="token punctuation" data-token-index="0">.</span><span class="" data-token-index="0">default_device</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"cpu"</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">:</span><span class="" data-token-index="0">
    </span><span class="token punctuation" data-token-index="0">.</span><span class="token punctuation" data-token-index="0">.</span><span class="token punctuation" data-token-index="0">.</span><span>
</span></div></div></div></div><div dir="auto" style="padding-inline-end: 105px;"></div></div>​<div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8079-9681-ee05f18186a6" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-sub_header-block" data-block-id="2680b1a7-76e1-807b-8f71-fbd1ac3a0667" style="width: 100%; max-width: 100%; margin-top: 1.4em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h3 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 2" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.5em; line-height: 1.3; margin: 0px;">Efficient Data Loading</h3><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8003-86de-f563f599706d" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.make_array_from_process_local_data()</span></div> overlaps data transfer and training on accelerators given a python iterator yielding a dict at each step (: async host → device data transfer)</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-column_list-block" data-block-id="26b0b1a7-76e1-800d-ba0b-f3bb3071d6e7" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex;"><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(33.3333% - 15.3333px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="26b0b1a7-76e1-805b-b0d8-e53fe31a4e98" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-callout-block" data-block-id="26b0b1a7-76e1-80e9-8b5b-cb293c5063a5" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 4px;"><div role="note" style="display: flex;"><div style="display: flex; width: 100%; border-radius: 10px; border: 1px solid transparent; background: var(--c-graBacSec); padding-inline: 20px; padding-top: 12px; padding-bottom: 12px;"><div style="display: flex; flex-direction: column; min-width: 0px; width: 100%; min-height: 32px;"><div class="notion-selectable notion-text-block" data-block-id="26b0b1a7-76e1-8019-8592-fc8d6821b000" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">    host</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="26b0b1a7-76e1-80be-9600-d4777c20223b" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">████████████…░░░░░░░░</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="26b0b1a7-76e1-8015-a8ee-d0ebdc869a6d" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">░░░░░░░░░░░░░░░░░░░░░</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div></div></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8087-b139-eff13469c190" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="26b0b1a7-76e1-8083-9d9e-d55e545c86b4" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div><div style="position: relative; width: 46px; flex-grow: 0; flex-shrink: 0; transition: opacity 200ms ease-out; opacity: 0;"></div><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(66.6667% - 30.6667px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="26b0b1a7-76e1-80a8-b1dd-c94e55be9be3" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-callout-block" data-block-id="26b0b1a7-76e1-8084-99dd-fd96befd3cdf" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div role="note" style="display: flex;"><div style="display: flex; width: 100%; border-radius: 10px; border: 1px solid transparent; background: var(--c-graBacSec); padding-inline: 20px; padding-top: 12px; padding-bottom: 12px;"><div style="display: flex; flex-direction: column; min-width: 0px; width: 100%; min-height: 32px;"><div class="notion-selectable notion-text-block" data-block-id="26b0b1a7-76e1-80e6-a089-f8c59ec6d3e0" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">          device</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div><div class="notion-selectable notion-column_list-block" data-block-id="26b0b1a7-76e1-8004-bf3c-e62378e3ab41" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="display: flex;"><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(42.8571% - 19.7143px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="26b0b1a7-76e1-8037-980e-e6f8c057b26b" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-text-block" data-block-id="26b0b1a7-76e1-80a3-b07e-c12f913573a2" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">  data transfer</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="26b0b1a7-76e1-8027-8b1e-e3cec7afa33d" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">██████████</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="26b0b1a7-76e1-8020-97f4-efde27644dfc" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">███…░░░░░░</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="26b0b1a7-76e1-804c-b17d-e35b2c04e740" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">░░░░░░░░░░</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div></div></div><div style="position: relative; width: 46px; flex-grow: 0; flex-shrink: 0; transition: opacity 200ms ease-out; opacity: 0;"></div><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(57.1429% - 26.2857px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="26b0b1a7-76e1-807d-acb8-f26d6588840a" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-text-block" data-block-id="26b0b1a7-76e1-8070-8a80-d6a96ccd885e" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">  train step</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="26b0b1a7-76e1-8032-9a5c-f7e0ef572d89" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><span class="notion-enable-hover" data-token-index="0" style="color:var(--c-redTexSec);fill:var(--c-redTexSec);isolation:auto">███████████████████████████████████████████████████████████████████████████</span></div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div></div></div></div></div></div></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div></div><div class="notion-selectable notion-toggle-block" data-block-id="2680b1a7-76e1-80e8-a762-f3f48b9de6ef" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px); padding-inline-end: 2px;"><div aria-controls=":rh:" aria-describedby=":rg:" aria-expanded="true" aria-label="Close" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; position: relative; display: flex; align-items: center; justify-content: center; width: 24px; height: 24px; border-radius: 4px;" tabindex="0"><svg aria-hidden="true" class="arrowCaretDownFillSmall" role="graphics-symbol" style="width: 0.8em; height: 0.8em; display: block; fill: inherit; flex-shrink: 0; color: inherit; transition: transform 200ms ease-out; transform: rotateZ(0deg); opacity: 1;" viewBox="0 0 16 16"><path d="M2.835 3.25a.8.8 0 0 0-.69 1.203l5.164 8.854a.8.8 0 0 0 1.382 0l5.165-8.854a.8.8 0 0 0-.691-1.203z"></path></svg></div></div><div style="flex: 1 1 0px; min-width: 1px;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" id=":rg:" placeholder="Toggle" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">temp</div><div style="position: relative; inset-inline-start: 0px;"></div></div><div id=":rh:" style="display: flex;"><div style="display: flex; flex-direction: column; width: 100%;"><div class="notion-selectable notion-bulleted_list-block" data-block-id="2680b1a7-76e1-8099-9029-ee502fb2e9fb" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/the-training-cookbook.html" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0">The Training Cookbook — JAX  documentation</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="2680b1a7-76e1-80a8-8ce4-defa4921f5a3" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">lost</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="2680b1a7-76e1-80a2-8143-c27bfee933d5" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/jax.lax.html#parallel-operators" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0">jax.lax module — JAX  documentation</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="2680b1a7-76e1-8008-b454-c110e631ea9a" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/multi_process.html" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0">Introduction to multi-controller JAX (aka multi-process/mult…</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div></div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="2760b1a7-76e1-8052-a811-d89bfe24127c" style="width: 100%; max-width: 100%; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h4 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.25em; line-height: 1.3; margin: 0px;">Data sharding ops: intermediate layout</h4><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2760b1a7-76e1-8029-967f-c120cc3b25a9" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.lax.with_sharding_constraint</span></div> a <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="2" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.device_put</span></div> like function that could be called niside a <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="4" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.jit</span></div> ted function to shard intermediate / output arrays manually</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8066-93f1-f60292290aa4" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="2790b1a7-76e1-8088-ae63-fcd34d994c24" style="width: 100%; max-width: 100%; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h4 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.25em; line-height: 1.3; margin: 0px;">Parameters Sharding</h4><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2790b1a7-76e1-801f-b2a0-f1b620c9304a" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>flax.linen.Partitioned</span></div> is a <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="2" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.numpy.array</span></div> wrapper that track an axis name, across which the array is sharded</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8000-bd5c-c9acc06526ad" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80e6-861e-d7f6039783ab" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-header-block" data-block-id="25c0b1a7-76e1-80ed-a020-faedeefa0349" style="width: 100%; max-width: 100%; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h2 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.875em; line-height: 1.3; margin: 0px;">Parallel Programming:</h2><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="25d0b1a7-76e1-8051-89ef-dc7f55f7f318" style="width: 100%; max-width: 100%; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h4 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.25em; line-height: 1.3; margin: 0px;">auto parallel via <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.jit</span></div> </h4><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-80ab-b9d2-d7563d3b6032" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">partial replication across device computations are replicated</div><div style="position: relative; inset-inline-start: 0px;"></div></div><div style="padding-inline-start: 1.5em; display: flex; flex-direction: column;"><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-8057-b595-cf9120338bb6" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">example: 2x4 mesh, 4x8 sharded array</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-801b-9e6f-c064e8757721" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">summing across the first axis each two devices in the first mesh axis replicate / store the same values / </div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="25d0b1a7-76e1-80bf-b288-dc2e049cdcf8" style="width: 100%; max-width: 100%; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h4 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.25em; line-height: 1.3; margin: 0px;">explicit parallel (manual configured auto compute)</h4><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-8095-b60d-c57c751b5afb" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">sharding is explicitly handled</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="25d0b1a7-76e1-8048-8410-ece0d29c5b98" style="width: 100%; max-width: 100%; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h4 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.25em; line-height: 1.3; margin: 0px;">manual parallel</h4><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-80d0-b262-fc5a16409714" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">a function is map sharded (as in CUDA kernels but for blocks)
for across shards operations use [lax utils.collective operations]</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-divider-block" data-block-id="25d0b1a7-76e1-80dd-b2f2-cca9d7f9ac0a" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div class="notion-cursor-default" style="display: flex; align-items: center; justify-content: center; pointer-events: auto; width: 100%; height: 13px; flex: 0 0 auto;"><div role="separator" style="width: 100%; height: 1px; visibility: visible; border-bottom: 1px solid var(--ca-borPriTra);"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-80aa-808a-d6c8644fca69" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">a mesh is the set / structure of devices, naming axis and setting their types (Explicit, Auto, …) than the <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.sharding.PartitionSpec</span></div> partitions an array across devices</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25c0b1a7-76e1-80d7-ba9e-cfe00c8f5e46" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.debug.visualize_array_sharding</span></div>:
 visualize an array position(sharded)</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25c0b1a7-76e1-8008-84d4-e594e3d956e4" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.make_mesh((arr_dim0, ...), (arr_dim0_name, ...), 
axi_s_types=(jax.sharding.AxisType.Explicit, ...))</span></div></div><div style="position: relative; inset-inline-start: 0px;"></div></div><div class="notion-selectable notion-text-block" data-block-id="25c0b1a7-76e1-80b6-bf95-f2619de0d370" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">creates a mesh / matrix with named axis</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25c0b1a7-76e1-807e-bf0e-d459322b9eb6" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.sharding.NamedSharding(mesh, partitioner)</span></div></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25d0b1a7-76e1-800b-87f1-eabf933f0546" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>with jax.set_mesh(mesh)</span></div> : set the native mesh to use for creation</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25c0b1a7-76e1-80e4-b5bb-c00e953355aa" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">example:</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-column_list-block" data-block-id="25d0b1a7-76e1-801c-9d64-fc1670f7ca9c" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex;"><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(33.3333% - 30.6667px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="25d0b1a7-76e1-801f-b1a2-f416e13073dd" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-80f5-8d78-e9b39fb7d320" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">x : [4@x, 1]</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-callout-block" data-block-id="25d0b1a7-76e1-80ff-8086-de177664c37d" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div role="note" style="display: flex;"><div style="display: flex; width: 100%; border-radius: 10px; border: 1px solid transparent; background: var(--c-graBacSec); padding-inline: 20px; padding-top: 12px; padding-bottom: 12px;"><div style="display: flex; flex-direction: column; min-width: 0px; width: 100%; min-height: 32px;"><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-80e3-8737-cdef4f99b593" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"> ██ ░░ ░░ ░░
 ██ ░░ ░░ ░░</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div></div></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div style="position: relative; width: 46px; flex-grow: 0; flex-shrink: 0; transition: opacity 200ms ease-out; opacity: 0;"></div><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(33.3333% - 30.6667px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="25d0b1a7-76e1-8072-a8b8-eaf280cdbb8d" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-80d2-8687-d0249cee67b7" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">x : [1, 8@y]</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-callout-block" data-block-id="25d0b1a7-76e1-8085-815a-ec3b3456993b" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div role="note" style="display: flex;"><div style="display: flex; width: 100%; border-radius: 10px; border: 1px solid transparent; background: var(--c-graBacSec); padding-inline: 20px; padding-top: 12px; padding-bottom: 12px;"><div style="display: flex; flex-direction: column; min-width: 0px; width: 100%; min-height: 32px;"><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-80b5-9ed5-ff4ac05e6b68" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"> ██ ██ ██ ██
 ░░ ░░ ░░ ░░</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div></div></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div style="position: relative; width: 46px; flex-grow: 0; flex-shrink: 0; transition: opacity 200ms ease-out; opacity: 0;"></div><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(33.3333% - 30.6667px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="25d0b1a7-76e1-806d-b0f3-d0aa1c2e9d3a" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-80f7-b4d5-fe4b2b79b9d9" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">x + y : [4@x, 8@y]</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-callout-block" data-block-id="25d0b1a7-76e1-802d-9dcd-e16e793d255d" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div role="note" style="display: flex;"><div style="display: flex; width: 100%; border-radius: 10px; border: 1px solid transparent; background: var(--c-graBacSec); padding-inline: 20px; padding-top: 12px; padding-bottom: 12px;"><div style="display: flex; flex-direction: column; min-width: 0px; width: 100%; min-height: 32px;"><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-807c-b3ff-f5496aa8011a" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">██ ██ ██ ██
██ ██ ██ ██</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div></div></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25c0b1a7-76e1-80ed-b283-e5487c3d6c43" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-80bb-b878-e1a0a2072094" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.mesh_map(func, mesh, in_specs=..., out_specs=...)</span></div> </div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-80d9-b996-cb4045555a29" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">example: </div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-8025-98d6-ec59b29dcc85" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">input  is sharded 4@x</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-8074-82cd-f3b69aec27ac" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">output is sharded 4@x</div><div style="position: relative; inset-inline-start: 0px;"></div></div><div style="padding-inline-start: 1.5em; display: flex; flex-direction: column;"><div class="notion-selectable notion-column_list-block" data-block-id="25d0b1a7-76e1-8050-951b-ffaa18389db2" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 0px;"><div style="display: flex;"><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(33.3333% - 30.6667px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="25d0b1a7-76e1-801d-8b46-fc1ffe85e7c5" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-8090-8073-c231d823f44a" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div><div style="position: relative; width: 46px; flex-grow: 0; flex-shrink: 0; transition: opacity 200ms ease-out; opacity: 0;"></div><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(33.3333% - 30.6667px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="25d0b1a7-76e1-80a0-b3c5-c3eb3dab4dc1" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-callout-block" data-block-id="25d0b1a7-76e1-80e9-af6b-cf09e05c4e6c" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div role="note" style="display: flex;"><div style="display: flex; width: 100%; border-radius: 10px; border: 1px solid transparent; background: var(--c-graBacSec); padding-inline: 20px; padding-top: 12px; padding-bottom: 12px;"><div style="display: flex; flex-direction: column; min-width: 0px; width: 100%; min-height: 32px;"><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-804e-ad39-e656ca88c91f" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">     mesh</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-8070-9455-f8bfe8b51659" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">    █ █ █ █</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div></div></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div style="position: relative; width: 46px; flex-grow: 0; flex-shrink: 0; transition: opacity 200ms ease-out; opacity: 0;"></div><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(33.3333% - 30.6667px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="25d0b1a7-76e1-80c4-ad01-e7420677d5a4" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-8092-bb93-f8d6e50fbdcf" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div></div></div></div></div></div><div class="notion-selectable notion-column_list-block" data-block-id="25d0b1a7-76e1-801f-95e2-ecdd1fbaeda1" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex;"><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(25.2033% - 34.7805px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="25d0b1a7-76e1-800c-a2b0-f053a61ec696" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-callout-block" data-block-id="25d0b1a7-76e1-80e4-bd11-d3d14ccda661" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div role="note" style="display: flex;"><div style="display: flex; width: 100%; border-radius: 10px; border: 1px solid transparent; background: var(--c-graBacSec); padding-inline: 20px; padding-top: 12px; padding-bottom: 12px;"><div style="display: flex; flex-direction: column; min-width: 0px; width: 100%; min-height: 32px;"><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-803d-9ef6-d1815868fe6e" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"> device0</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-80a5-b7de-dbd3195398b1" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"> <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>█</span></div>█ █ █</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div></div></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div style="position: relative; width: 46px; flex-grow: 0; flex-shrink: 0; transition: opacity 200ms ease-out; opacity: 0;"></div><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(25.2033% - 34.7805px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="25d0b1a7-76e1-800b-88a8-f51e9e2a376c" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-callout-block" data-block-id="25d0b1a7-76e1-8072-a8b7-dc328400ca72" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div role="note" style="display: flex;"><div style="display: flex; width: 100%; border-radius: 10px; border: 1px solid transparent; background: var(--c-graBacSec); padding-inline: 20px; padding-top: 12px; padding-bottom: 12px;"><div style="display: flex; flex-direction: column; min-width: 0px; width: 100%; min-height: 32px;"><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-80f1-b39a-c4459c38b819" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"> device1</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-8016-982b-d2dd600b9caf" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">  █<div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>█</span></div>█ █</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div></div></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div style="position: relative; width: 46px; flex-grow: 0; flex-shrink: 0; transition: opacity 200ms ease-out; opacity: 0;"></div><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(25.2033% - 34.7805px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="25d0b1a7-76e1-802d-9eb7-e095103b7f40" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-callout-block" data-block-id="25d0b1a7-76e1-807e-bef2-ca7065cc49b3" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div role="note" style="display: flex;"><div style="display: flex; width: 100%; border-radius: 10px; border: 1px solid transparent; background: var(--c-graBacSec); padding-inline: 20px; padding-top: 12px; padding-bottom: 12px;"><div style="display: flex; flex-direction: column; min-width: 0px; width: 100%; min-height: 32px;"><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-803e-a471-ddfa67237ac9" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"> device2</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-8070-ad34-d7686eb0b3cd" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">  █ █<div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>█</span></div>█</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div></div></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div style="position: relative; width: 46px; flex-grow: 0; flex-shrink: 0; transition: opacity 200ms ease-out; opacity: 0;"></div><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(24.3902% - 33.6585px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="25d0b1a7-76e1-8018-96e6-cb6d714c2045" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-callout-block" data-block-id="25d0b1a7-76e1-80d3-99a0-efe6b4da946f" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div role="note" style="display: flex;"><div style="display: flex; width: 100%; border-radius: 10px; border: 1px solid transparent; background: var(--c-graBacSec); padding-inline: 20px; padding-top: 12px; padding-bottom: 12px;"><div style="display: flex; flex-direction: column; min-width: 0px; width: 100%; min-height: 32px;"><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-80b2-bef7-e77f7c8469cd" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"> device3
 █ █ █<div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>█</span></div></div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div></div></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div></div><div class="notion-selectable notion-column_list-block" data-block-id="25d0b1a7-76e1-80fe-85db-e1913aa46bd0" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex;"><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(33.3333% - 30.6667px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="25d0b1a7-76e1-8070-9242-ca98d38b8ea9" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-808c-896b-ed4d5d62608b" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div><div style="position: relative; width: 46px; flex-grow: 0; flex-shrink: 0; transition: opacity 200ms ease-out; opacity: 0;"></div><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(33.3333% - 30.6667px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="25d0b1a7-76e1-8066-a32b-dd535c706414" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-80c2-a9e1-dd56a613c33a" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">[collective ops ?]</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-callout-block" data-block-id="25d0b1a7-76e1-80eb-a962-f4ff0c470a89" style="width: 100%; max-width: 100%; margin-top: 4px; margin-bottom: 0px;"><div role="note" style="display: flex;"><div style="display: flex; width: 100%; border-radius: 10px; border: 1px solid transparent; background: var(--c-graBacSec); padding-inline: 20px; padding-top: 12px; padding-bottom: 12px;"><div style="display: flex; flex-direction: column; min-width: 0px; width: 100%; min-height: 32px;"><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-8083-810c-ce483f334c6a" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">      mesh</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-80ae-bca5-e1f98f530797" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">     █ █ █ █</div><div style="position: relative; inset-inline-start: 20px;"></div></div></div></div></div></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div style="position: relative; width: 46px; flex-grow: 0; flex-shrink: 0; transition: opacity 200ms ease-out; opacity: 0;"></div><div style="padding-top: 12px; padding-bottom: 12px; flex-grow: 0; flex-shrink: 0; width: calc(33.3333% - 30.6667px); transition-duration: 200ms; transition-timing-function: ease; transition-property: width;"><div class="notion-selectable notion-column-block" data-block-id="25d0b1a7-76e1-8005-9d1a-ed067ec99255" style="display: flex; flex-direction: column;"><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-80c4-812b-e6f84fd736a4" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25d0b1a7-76e1-807b-9520-c135058d38ab" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">each device does it’s computation that the output is sharded accordingly</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25c0b1a7-76e1-805f-94e2-d830d90ab8c8" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-toggle-block" data-block-id="25b0b1a7-76e1-80fa-8939-e08fd73d25e4" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px); padding-inline-end: 2px;"><div aria-controls=":ru:" aria-describedby=":rt:" aria-expanded="true" aria-label="Close" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; position: relative; display: flex; align-items: center; justify-content: center; width: 24px; height: 24px; border-radius: 4px;" tabindex="0"><svg aria-hidden="true" class="arrowCaretDownFillSmall" role="graphics-symbol" style="width: 0.8em; height: 0.8em; display: block; fill: inherit; flex-shrink: 0; color: inherit; transition: transform 200ms ease-out; transform: rotateZ(0deg); opacity: 1;" viewBox="0 0 16 16"><path d="M2.835 3.25a.8.8 0 0 0-.69 1.203l5.164 8.854a.8.8 0 0 0 1.382 0l5.165-8.854a.8.8 0 0 0-.691-1.203z"></path></svg></div></div><div style="flex: 1 1 0px; min-width: 1px;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" id=":rt:" placeholder="Toggle" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">potential practice micro projects</div><div style="position: relative; inset-inline-start: 0px;"></div></div><div id=":ru:" style="display: flex;"><div style="display: flex; flex-direction: column; width: 100%;"><div class="notion-selectable notion-bulleted_list-block" data-block-id="25b0b1a7-76e1-80dd-a133-dbfdc801f23b" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">RNN with lax.scan</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25b0b1a7-76e1-809f-9121-d022fe85f085" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">vmapped operation with pytree config (same weight over multiple inputs)</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="27a0b1a7-76e1-808c-a1c8-e22961a52da2" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div></div></div></div><div class="notion-selectable notion-sub_header-block" data-block-id="27a0b1a7-76e1-80d0-9a77-e22385b04b9b" style="width: 100%; max-width: 100%; margin-top: 1.4em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><h3 contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 2" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; font-weight: 600; font-size: 1.5em; line-height: 1.3; margin: 0px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>#jax.shard_map</span></div> </h3><div style="position: relative; inset-inline-start: 0px;"></div></div></div><div class="notion-selectable notion-text-block" data-block-id="27a0b1a7-76e1-8081-beb4-fb6d29d249cd" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">a parallelization transform that execture a given function <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>func</span></div> on sharded inputs as specified by <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="3" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>in_specs</span></div> then collects / re-assemble outputs as specified by <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="5" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>out_specs</span></div> on the given device mesh</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="27a0b1a7-76e1-80ab-8ecb-c4eb36a3f774" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">(note for my fish memory: <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>shard_map</span></div> does the sharding according to <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="3" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>in_specs</span></div> not need (generally) to pre-shard inputs unless intended)</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="27a0b1a7-76e1-8088-9e38-ddd38b586ef6" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="27a0b1a7-76e1-8086-b92c-e63ae74a2119" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>in_specs</span></div> None → replicate, axis_name → shard on this mesh axis</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="27a0b1a7-76e1-80ce-8395-c3e5eaecd58e" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;"><div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="0" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>out_specs</span></div> None → fetch a single copy, no need to tile it’s already replicated (unvarying), axis_name → collect</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80be-9b86-d0e21e937dfc" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px;">use <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="1" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.lax.pvary</span></div> to label a varying value to execute operations with other varying values (mostly added <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="3" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>jax.lax</span></div> in <div class="notion-inline-code-container" style="display:inline"><span class="notion-enable-hover" data-token-index="5" spellcheck="false" style='font-family:"SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace;line-height:normal;background:rgba(135,131,120,.15);color:#EB5757;border-radius:4px;font-size:85%;padding:0.2em 0.4em;position:relative;bottom:0.065em'>JAXPER</span></div>s to pass to the XLA, mentioned just in case a khazoo9 is encountered)</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80a0-89af-e07d0e886a12" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2bc0b1a7-76e1-8054-a77a-d00c27a54acd" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="2bc0b1a7-76e1-80f7-afe0-fdb9569d4fe7" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-toggle-block" data-block-id="25a0b1a7-76e1-8055-ab0f-ee0cb3268703" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px); padding-inline-end: 2px;"><div aria-controls=":r10:" aria-describedby=":rv:" aria-expanded="true" aria-label="Close" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; position: relative; display: flex; align-items: center; justify-content: center; width: 24px; height: 24px; border-radius: 4px;" tabindex="0"><svg aria-hidden="true" class="arrowCaretDownFillSmall" role="graphics-symbol" style="width: 0.8em; height: 0.8em; display: block; fill: inherit; flex-shrink: 0; color: inherit; transition: transform 200ms ease-out; transform: rotateZ(0deg); opacity: 1;" viewBox="0 0 16 16"><path d="M2.835 3.25a.8.8 0 0 0-.69 1.203l5.164 8.854a.8.8 0 0 0 1.382 0l5.165-8.854a.8.8 0 0 0-.691-1.203z"></path></svg></div></div><div style="flex: 1 1 0px; min-width: 1px;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" id=":rv:" placeholder="Toggle" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">read pages</div><div style="position: relative; inset-inline-start: 0px;"></div></div><div id=":r10:" style="display: flex;"><div style="display: flex; flex-direction: column; width: 100%;"><div class="notion-selectable notion-bulleted_list-block" data-block-id="25a0b1a7-76e1-80a0-bb1d-eb00c1231920" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/notebooks/thinking_in_jax.html" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0">Quickstart: How to think in JAX — JAX  documentation</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25a0b1a7-76e1-80c6-ab7f-f4423e9f3881" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/key-concepts.html#jax-arrays-jax-array" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0">Key concepts — JAX  documentation</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25a0b1a7-76e1-8030-893b-f9c0bf02676c" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/type_promotion.html#weak-types" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0">Type promotion semantics — JAX  documentation</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25a0b1a7-76e1-802f-8a4a-c4eee9e7cc75" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">Tutorials</div><div style="position: relative; inset-inline-start: 0px;"></div></div><div class="notion-selectable notion-toggle-block" data-block-id="25a0b1a7-76e1-801a-b341-efda551ae80b" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px); padding-inline-end: 2px;"><div aria-controls=":r14:" aria-describedby=":r13:" aria-expanded="true" aria-label="Close" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; position: relative; display: flex; align-items: center; justify-content: center; width: 24px; height: 24px; border-radius: 4px;" tabindex="0"><svg aria-hidden="true" class="arrowCaretDownFillSmall" role="graphics-symbol" style="width: 0.8em; height: 0.8em; display: block; fill: inherit; flex-shrink: 0; color: inherit; transition: transform 200ms ease-out; transform: rotateZ(0deg); opacity: 1;" viewBox="0 0 16 16"><path d="M2.835 3.25a.8.8 0 0 0-.69 1.203l5.164 8.854a.8.8 0 0 0 1.382 0l5.165-8.854a.8.8 0 0 0-.691-1.203z"></path></svg></div></div><div style="flex: 1 1 0px; min-width: 1px;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" id=":r13:" placeholder="Toggle" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/jit-compilation.html" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0">Just-in-time compilation — JAX  documentation</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div><div id=":r14:" style="display: flex;"><div style="display: flex; flex-direction: column; width: 100%;"><div class="notion-selectable notion-bulleted_list-block" data-block-id="25b0b1a7-76e1-800d-a169-c1e7ff807014" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">jax.experimental.io_callback()</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25b0b1a7-76e1-80a9-b9fe-c8715b66d217" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">jax.check_tracer_leaks()</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25b0b1a7-76e1-80e4-b215-f7e88a1a68f4" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">asynchronous dispatch</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25b0b1a7-76e1-80b4-a046-dcb9041bf7c4" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"> <a class="notion-link-token notion-focusable-token notion-enable-hover" data-token-index="1" href="https://docs.jax.dev/en/latest/control-flow.html#control-flow" rel="noopener noreferrer" style="cursor:pointer;color:inherit;word-wrap:break-word;text-decoration:inherit" tabindex="0"><span class="link-annotation-25b0b1a7-76e1-80b4-a046-dcb9041bf7c4--1103532781" style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--ca-opaLinDecCol);text-underline-offset:10%;opacity:0.7">Control flow and logical operators with JIT</span></a>.</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div></div></div></div></div><div class="notion-selectable notion-toggle-block" data-block-id="25b0b1a7-76e1-8075-9d59-e1337cdbd58c" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px); padding-inline-end: 2px;"><div aria-controls=":r16:" aria-describedby=":r15:" aria-expanded="true" aria-label="Close" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; position: relative; display: flex; align-items: center; justify-content: center; width: 24px; height: 24px; border-radius: 4px;" tabindex="0"><svg aria-hidden="true" class="arrowCaretDownFillSmall" role="graphics-symbol" style="width: 0.8em; height: 0.8em; display: block; fill: inherit; flex-shrink: 0; color: inherit; transition: transform 200ms ease-out; transform: rotateZ(0deg); opacity: 0.5;" viewBox="0 0 16 16"><path d="M2.835 3.25a.8.8 0 0 0-.69 1.203l5.164 8.854a.8.8 0 0 0 1.382 0l5.165-8.854a.8.8 0 0 0-.691-1.203z"></path></svg></div></div><div style="flex: 1 1 0px; min-width: 1px;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" id=":r15:" placeholder="Toggle" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/automatic-vectorization.html" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0">Automatic vectorization — JAX  documentation</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div><div id=":r16:" style="display: flex;"><div style="display: flex; flex-direction: column; width: 100%;"></div></div></div></div></div><div class="notion-selectable notion-toggle-block" data-block-id="25b0b1a7-76e1-804f-b840-c2fafd1ed1aa" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px); padding-inline-end: 2px;"><div aria-controls=":r18:" aria-describedby=":r17:" aria-expanded="true" aria-label="Close" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; position: relative; display: flex; align-items: center; justify-content: center; width: 24px; height: 24px; border-radius: 4px;" tabindex="0"><svg aria-hidden="true" class="arrowCaretDownFillSmall" role="graphics-symbol" style="width: 0.8em; height: 0.8em; display: block; fill: inherit; flex-shrink: 0; color: inherit; transition: transform 200ms ease-out; transform: rotateZ(0deg); opacity: 0.5;" viewBox="0 0 16 16"><path d="M2.835 3.25a.8.8 0 0 0-.69 1.203l5.164 8.854a.8.8 0 0 0 1.382 0l5.165-8.854a.8.8 0 0 0-.691-1.203z"></path></svg></div></div><div style="flex: 1 1 0px; min-width: 1px;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" id=":r17:" placeholder="Toggle" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/automatic-differentiation.html" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0">Automatic differentiation — JAX  documentation</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div><div id=":r18:" style="display: flex;"><div style="display: flex; flex-direction: column; width: 100%;"></div></div></div></div></div><div class="notion-selectable notion-toggle-block" data-block-id="25b0b1a7-76e1-80d6-beed-ee9c12793fe6" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px); padding-inline-end: 2px;"><div aria-controls=":r1a:" aria-describedby=":r19:" aria-expanded="true" aria-label="Close" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; position: relative; display: flex; align-items: center; justify-content: center; width: 24px; height: 24px; border-radius: 4px;" tabindex="0"><svg aria-hidden="true" class="arrowCaretDownFillSmall" role="graphics-symbol" style="width: 0.8em; height: 0.8em; display: block; fill: inherit; flex-shrink: 0; color: inherit; transition: transform 200ms ease-out; transform: rotateZ(0deg); opacity: 0.5;" viewBox="0 0 16 16"><path d="M2.835 3.25a.8.8 0 0 0-.69 1.203l5.164 8.854a.8.8 0 0 0 1.382 0l5.165-8.854a.8.8 0 0 0-.691-1.203z"></path></svg></div></div><div style="flex: 1 1 0px; min-width: 1px;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" id=":r19:" placeholder="Toggle" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/working-with-pytrees.html" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0">Working with pytrees — JAX  documentation</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div><div id=":r1a:" style="display: flex;"><div style="display: flex; flex-direction: column; width: 100%;"></div></div></div></div></div><div class="notion-selectable notion-toggle-block" data-block-id="25b0b1a7-76e1-80b7-83fd-ef87647f8626" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px); padding-inline-end: 2px;"><div aria-controls=":r1c:" aria-describedby=":r1b:" aria-expanded="true" aria-label="Close" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; position: relative; display: flex; align-items: center; justify-content: center; width: 24px; height: 24px; border-radius: 4px;" tabindex="0"><svg aria-hidden="true" class="arrowCaretDownFillSmall" role="graphics-symbol" style="width: 0.8em; height: 0.8em; display: block; fill: inherit; flex-shrink: 0; color: inherit; transition: transform 200ms ease-out; transform: rotateZ(0deg); opacity: 0.5;" viewBox="0 0 16 16"><path d="M2.835 3.25a.8.8 0 0 0-.69 1.203l5.164 8.854a.8.8 0 0 0 1.382 0l5.165-8.854a.8.8 0 0 0-.691-1.203z"></path></svg></div></div><div style="flex: 1 1 0px; min-width: 1px;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" id=":r1b:" placeholder="Toggle" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/random-numbers.html" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0">Pseudorandom numbers — JAX  documentation</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div><div id=":r1c:" style="display: flex;"><div style="display: flex; flex-direction: column; width: 100%;"></div></div></div></div></div><div class="notion-selectable notion-toggle-block" data-block-id="25b0b1a7-76e1-80db-96d1-f0d5cca53f49" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px); padding-inline-end: 2px;"><div aria-controls=":r1e:" aria-describedby=":r1d:" aria-expanded="true" aria-label="Close" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; position: relative; display: flex; align-items: center; justify-content: center; width: 24px; height: 24px; border-radius: 4px;" tabindex="0"><svg aria-hidden="true" class="arrowCaretDownFillSmall" role="graphics-symbol" style="width: 0.8em; height: 0.8em; display: block; fill: inherit; flex-shrink: 0; color: inherit; transition: transform 200ms ease-out; transform: rotateZ(0deg); opacity: 0.5;" viewBox="0 0 16 16"><path d="M2.835 3.25a.8.8 0 0 0-.69 1.203l5.164 8.854a.8.8 0 0 0 1.382 0l5.165-8.854a.8.8 0 0 0-.691-1.203z"></path></svg></div></div><div style="flex: 1 1 0px; min-width: 1px;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" id=":r1d:" placeholder="Toggle" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/sharded-computation.html" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0">Introduction to parallel programming — JAX  documentation</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div><div id=":r1e:" style="display: flex;"><div style="display: flex; flex-direction: column; width: 100%;"></div></div></div></div></div><div class="notion-selectable notion-toggle-block" data-block-id="25c0b1a7-76e1-802c-b306-c0ff9656eace" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px); padding-inline-end: 2px;"><div aria-controls=":r1g:" aria-describedby=":r1f:" aria-expanded="true" aria-label="Close" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; position: relative; display: flex; align-items: center; justify-content: center; width: 24px; height: 24px; border-radius: 4px;" tabindex="0"><svg aria-hidden="true" class="arrowCaretDownFillSmall" role="graphics-symbol" style="width: 0.8em; height: 0.8em; display: block; fill: inherit; flex-shrink: 0; color: inherit; transition: transform 200ms ease-out; transform: rotateZ(0deg); opacity: 0.5;" viewBox="0 0 16 16"><path d="M2.835 3.25a.8.8 0 0 0-.69 1.203l5.164 8.854a.8.8 0 0 0 1.382 0l5.165-8.854a.8.8 0 0 0-.691-1.203z"></path></svg></div></div><div style="flex: 1 1 0px; min-width: 1px;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" id=":r1f:" placeholder="Toggle" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/control-flow.html" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0">Control flow and logical operators with JIT — JAX  documenta…</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div><div id=":r1g:" style="display: flex;"><div style="display: flex; flex-direction: column; width: 100%;"></div></div></div></div></div><div class="notion-selectable notion-toggle-block" data-block-id="25c0b1a7-76e1-80ee-9560-dcebf1cb03fe" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px); padding-inline-end: 2px;"><div aria-controls=":r1i:" aria-describedby=":r1h:" aria-expanded="true" aria-label="Close" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; position: relative; display: flex; align-items: center; justify-content: center; width: 24px; height: 24px; border-radius: 4px;" tabindex="0"><svg aria-hidden="true" class="arrowCaretDownFillSmall" role="graphics-symbol" style="width: 0.8em; height: 0.8em; display: block; fill: inherit; flex-shrink: 0; color: inherit; transition: transform 200ms ease-out; transform: rotateZ(0deg); opacity: 0.5;" viewBox="0 0 16 16"><path d="M2.835 3.25a.8.8 0 0 0-.69 1.203l5.164 8.854a.8.8 0 0 0 1.382 0l5.165-8.854a.8.8 0 0 0-.691-1.203z"></path></svg></div></div><div style="flex: 1 1 0px; min-width: 1px;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" id=":r1h:" placeholder="Toggle" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/stateful-computations.html" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0">Stateful computations — JAX  documentation</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div><div id=":r1i:" style="display: flex;"><div style="display: flex; flex-direction: column; width: 100%;"></div></div></div></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="2660b1a7-76e1-8056-a376-f72316410af7" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">Resources &amp; Advanced guids</div><div style="position: relative; inset-inline-start: 0px;"></div></div><div class="notion-selectable notion-toggle-block" data-block-id="25b0b1a7-76e1-802b-8fcc-efe1e181d622" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px); padding-inline-end: 2px;"><div aria-controls=":r1k:" aria-describedby=":r1j:" aria-expanded="true" aria-label="Close" role="button" style="user-select: none; transition: background 20ms ease-in; cursor: pointer; position: relative; display: flex; align-items: center; justify-content: center; width: 24px; height: 24px; border-radius: 4px;" tabindex="0"><svg aria-hidden="true" class="arrowCaretDownFillSmall" role="graphics-symbol" style="width: 0.8em; height: 0.8em; display: block; fill: inherit; flex-shrink: 0; color: inherit; transition: transform 200ms ease-out; transform: rotateZ(0deg); opacity: 0.5;" viewBox="0 0 16 16"><path d="M2.835 3.25a.8.8 0 0 0-.69 1.203l5.164 8.854a.8.8 0 0 0 1.382 0l5.165-8.854a.8.8 0 0 0-.691-1.203z"></path></svg></div></div><div style="flex: 1 1 0px; min-width: 1px;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" id=":r1j:" placeholder="Toggle" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/debugging.html" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0">Introduction to debugging — JAX  documentation</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div><div id=":r1k:" style="display: flex;"><div style="display: flex; flex-direction: column; width: 100%;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="27a0b1a7-76e1-808f-93f3-e8815b93a76b" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "◦";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/notebooks/shard_map.html" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0">Manual parallelism with shard_map — JAX  documentation</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="2770b1a7-76e1-8083-8433-ddaa402569fd" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "◦";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/notebooks/Distributed_arrays_and_automatic_parallelization.html" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0">Distributed arrays and automatic parallelization — JAX  docu…</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="2770b1a7-76e1-8063-96ec-dc44456d2994" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "◦";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/gradient-checkpointing.html" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0">Gradient checkpointing with jax.checkpoint (jax.remat) — JAX…</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25b0b1a7-76e1-8009-8a68-dc0120b1285f" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/notebooks/Common_Gotchas_in_JAX.html" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0"><img alt="🔪" class="notion-emoji" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" style="width: 1em;
height: 1em;
background-repeat: no-repeat;
background: url(6101f88ab4529ee25e026ff331f3a4a5b65ac27c.png);
background-position-x: 50%;
background-position-y: 10%;
background-size: 6100% 6100%;
vertical-align: -0.1em;
margin: 0 0.1em"/> JAX - The Sharp Bits <img alt="🔪" class="notion-emoji" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" style="width: 1em;
height: 1em;
background-repeat: no-repeat;
background: url(6101f88ab4529ee25e026ff331f3a4a5b65ac27c.png);
background-position-x: 50%;
background-position-y: 10%;
background-size: 6100% 6100%;
vertical-align: -0.1em;
margin: 0 0.1em"/> — JAX  documentation</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25a0b1a7-76e1-8027-8bf0-dfda367c4aab" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/glossary.html#term-Tracer" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0">Glossary of terms — JAX  documentation</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25a0b1a7-76e1-8052-884f-e38b96078dbf" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/type_promotion.html#weak-types" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0">Type promotion semantics — JAX  documentation</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="25a0b1a7-76e1-8098-82fa-fa881dd66a84" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;">notes</div><div style="position: relative; inset-inline-start: 0px;"></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="2670b1a7-76e1-80a1-a8ec-e9ffe43d4d9d" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 0px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-inline-start: 2px; color: inherit; fill: inherit;"><div class="notion-list-item-box-left pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background: transparent; margin-inline-end: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 6px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily: Arial; --pseudoBefore--content: "◦";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; text-align: start;"><a class="notion-link-mention-token notion-text-mention-token notion-focusable-token notion-enable-hover" contenteditable="false" data-token-index="0" href="https://docs.jax.dev/en/latest/async_dispatch.html#async-dispatch" rel="noopener noreferrer" style="color:inherit;text-decoration:inherit;cursor:pointer" tabindex="0" target="_blank"><img alt="" src="0290ada811c5246156f67938cf0fc01ec733f80f.png" style="width:1.2em;height:1.2em;border-radius:3px;vertical-align:-0.22em;margin-inline-end:0.3em"/><span class=""><span style="text-decoration:underline;text-decoration-thickness:0.05em;text-decoration-color:var(--cl-linDecCol);text-underline-offset:10%;font-weight:500;flex-shrink:0">Asynchronous dispatch — JAX  documentation</span></span></a>​</div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-801c-b496-f05b17eced41" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8079-8c27-fe2ddc7c8be9" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80a0-8789-eab3ad05c321" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8034-9f95-dc2b1e3dc95f" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8059-92fa-c616b5828dbb" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80ed-8693-d636ff03ac9c" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8058-83fc-e60497dc24f9" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-801f-908a-ed46378f7ee4" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-801b-9c20-e2388eca6908" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80db-96cc-efef2f38ef76" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8026-932f-c21b96d27937" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80d8-8881-e738ddc2012c" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-805e-8257-e5adb88c8259" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-804e-b02c-dcab3850c5d1" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-805b-b237-c49d28c45b92" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8046-8ff9-ce9ef01a0467" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8012-bba1-ff4b96bbc530" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80e8-8d1f-d5eec3600a04" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8087-894b-cd4a61000256" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8066-bb44-d02700efdb93" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8053-8613-c4ccd1103636" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8094-b430-c12e1f889d41" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-801e-ab4b-d72b0479c12e" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-800e-9f71-e0841d6ec2a6" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80f1-8e0a-e1694691754c" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8022-9cd7-dbd2920f64f3" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-800c-a8db-c8986a9686e2" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80bb-9d19-c461f0de52eb" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8010-ba8a-f0032d0043bf" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8024-853b-dc360ca84b22" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8074-832d-dec2320bafe3" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80c1-9655-c1c93074f6a7" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80d0-99e7-c22f3fff35f1" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-806c-a8cd-e60eebaffbc7" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8071-83cc-ec9241807055" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8020-9cb5-e7d3bb6b489d" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80bf-991a-e0a6db909b34" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8070-aa2e-d91dd7a7e9c5" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8041-92fd-f1f66e051159" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80b3-876c-dca5635e22a1" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80ca-aff4-d440de1eafd7" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-809c-8ae2-da0b633de180" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-8030-b6fa-eeb004d0d031" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-802c-9c1f-ed9e042d0fc2" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80ed-8da7-f3e5bb4b0ee5" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80c5-9e68-ea42f55364d3" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="25a0b1a7-76e1-80bc-9ba8-d468c66f7542" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: break-spaces; word-break: break-word; caret-color: var(--c-texPri); padding-top: 3px; padding-bottom: 3px; padding-inline: 2px; min-height: 1em; color: var(--c-texPri); -webkit-text-fill-color: var(--c-texTer);"></div><div style="position: relative; inset-inline-start: 0px;"></div></div></div></div></div></div></div></div></div></div></div><span data-content-editable-root-tiny-selection-trap="true" style="height: 1px; width: 1px; caret-color: transparent;"></span></div><div class="notion-presence-container" style="position: absolute; top: 0px; inset-inline-start: 0px; z-index: 89;"><div></div></div><div class="sticky-portal-target" data-sticky-stack-name="default" style="position: sticky; z-index: 85; width: 100%; bottom: 0px; inset-inline-start: 0px; flex: 0 1 0%;"></div></div></div></main><div aria-hidden="true" aria-label="Side Peek" class="notion-peek-renderer" role="region" style="position: absolute; top: 0px; inset-inline-end: 0px; bottom: 0px; width: 960px; z-index: 109; transform: translateX(calc(var(--direction, 1) * 960px)) translateZ(0); transition-duration: 200ms; transition-timing-function: ease; transition-property: width, transform;"></div></div></div></div><div style="display: block; position: fixed; visibility: hidden; overflow-y: scroll; width: 20px; height: 20px;"></div></div></div></div></body></html>